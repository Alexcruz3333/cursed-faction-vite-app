function kn(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}const vs=(t,e)=>{let n;switch(t){case"standard":return n=e,`data:image/svg+xml,%3Csvg width='${e}' height='${n}' viewBox='0 0 1024 1024' fill='none' xmlns='http://www.w3.org/2000/svg'%3E %3Crect width='1024' height='1024' fill='%230052FF'/%3E %3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M152 512C152 710.823 313.177 872 512 872C710.823 872 872 710.823 872 512C872 313.177 710.823 152 512 152C313.177 152 152 313.177 152 512ZM420 396C406.745 396 396 406.745 396 420V604C396 617.255 406.745 628 420 628H604C617.255 628 628 617.255 628 604V420C628 406.745 617.255 396 604 396H420Z' fill='white'/%3E %3C/svg%3E `;case"circle":return n=e,`data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='${e}' height='${n}' viewBox='0 0 999.81 999.81'%3E%3Cdefs%3E%3Cstyle%3E.cls-1%7Bfill:%230052fe;%7D.cls-2%7Bfill:%23fefefe;%7D.cls-3%7Bfill:%230152fe;%7D%3C/style%3E%3C/defs%3E%3Cpath class='cls-1' d='M655-115.9h56c.83,1.59,2.36.88,3.56,1a478,478,0,0,1,75.06,10.42C891.4-81.76,978.33-32.58,1049.19,44q116.7,126,131.94,297.61c.38,4.14-.34,8.53,1.78,12.45v59c-1.58.84-.91,2.35-1,3.56a482.05,482.05,0,0,1-10.38,74.05c-24,106.72-76.64,196.76-158.83,268.93s-178.18,112.82-287.2,122.6c-4.83.43-9.86-.25-14.51,1.77H654c-1-1.68-2.69-.91-4.06-1a496.89,496.89,0,0,1-105.9-18.59c-93.54-27.42-172.78-77.59-236.91-150.94Q199.34,590.1,184.87,426.58c-.47-5.19.25-10.56-1.77-15.59V355c1.68-1,.91-2.7,1-4.06a498.12,498.12,0,0,1,18.58-105.9c26-88.75,72.64-164.9,140.6-227.57q126-116.27,297.21-131.61C645.32-114.57,650.35-113.88,655-115.9Zm377.92,500c0-192.44-156.31-349.49-347.56-350.15-194.13-.68-350.94,155.13-352.29,347.42-1.37,194.55,155.51,352.1,348.56,352.47C876.15,734.23,1032.93,577.84,1032.93,384.11Z' transform='translate(-183.1 115.9)'/%3E%3Cpath class='cls-2' d='M1032.93,384.11c0,193.73-156.78,350.12-351.29,349.74-193-.37-349.93-157.92-348.56-352.47C334.43,189.09,491.24,33.28,685.37,34,876.62,34.62,1032.94,191.67,1032.93,384.11ZM683,496.81q43.74,0,87.48,0c15.55,0,25.32-9.72,25.33-25.21q0-87.48,0-175c0-15.83-9.68-25.46-25.59-25.46H595.77c-15.88,0-25.57,9.64-25.58,25.46q0,87.23,0,174.45c0,16.18,9.59,25.7,25.84,25.71Z' transform='translate(-183.1 115.9)'/%3E%3Cpath class='cls-3' d='M683,496.81H596c-16.25,0-25.84-9.53-25.84-25.71q0-87.23,0-174.45c0-15.82,9.7-25.46,25.58-25.46H770.22c15.91,0,25.59,9.63,25.59,25.46q0,87.47,0,175c0,15.49-9.78,25.2-25.33,25.21Q726.74,496.84,683,496.81Z' transform='translate(-183.1 115.9)'/%3E%3C/svg%3E`;case"text":return n=(.1*e).toFixed(2),`data:image/svg+xml,%3Csvg width='${e}' height='${n}' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 528.15 53.64'%3E%3Cdefs%3E%3Cstyle%3E.cls-1%7Bfill:%230052ff;%7D%3C/style%3E%3C/defs%3E%3Ctitle%3ECoinbase_Wordmark_SubBrands_ALL%3C/title%3E%3Cpath class='cls-1' d='M164.45,15a15,15,0,0,0-11.74,5.4V0h-8.64V52.92h8.5V48a15,15,0,0,0,11.88,5.62c10.37,0,18.21-8.21,18.21-19.3S174.67,15,164.45,15Zm-1.3,30.67c-6.19,0-10.73-4.83-10.73-11.31S157,23,163.22,23s10.66,4.82,10.66,11.37S169.34,45.65,163.15,45.65Zm83.31-14.91-6.34-.93c-3-.43-5.18-1.44-5.18-3.82,0-2.59,2.8-3.89,6.62-3.89,4.18,0,6.84,1.8,7.42,4.76h8.35c-.94-7.49-6.7-11.88-15.55-11.88-9.15,0-15.2,4.68-15.2,11.3,0,6.34,4,10,12,11.16l6.33.94c3.1.43,4.83,1.65,4.83,4,0,2.95-3,4.17-7.2,4.17-5.12,0-8-2.09-8.43-5.25h-8.49c.79,7.27,6.48,12.38,16.84,12.38,9.44,0,15.7-4.32,15.7-11.74C258.12,35.28,253.58,31.82,246.46,30.74Zm-27.65-2.3c0-8.06-4.9-13.46-15.27-13.46-9.79,0-15.26,5-16.34,12.6h8.57c.43-3,2.73-5.4,7.63-5.4,4.39,0,6.55,1.94,6.55,4.32,0,3.09-4,3.88-8.85,4.39-6.63.72-14.84,3-14.84,11.66,0,6.7,5,11,12.89,11,6.19,0,10.08-2.59,12-6.7.28,3.67,3,6.05,6.84,6.05h5v-7.7h-4.25Zm-8.5,9.36c0,5-4.32,8.64-9.57,8.64-3.24,0-6-1.37-6-4.25,0-3.67,4.39-4.68,8.42-5.11s6-1.22,7.13-2.88ZM281.09,15c-11.09,0-19.23,8.35-19.23,19.36,0,11.6,8.72,19.3,19.37,19.3,9,0,16.06-5.33,17.86-12.89h-9c-1.3,3.31-4.47,5.19-8.71,5.19-5.55,0-9.72-3.46-10.66-9.51H299.3V33.12C299.3,22.46,291.53,15,281.09,15Zm-9.87,15.26c1.37-5.18,5.26-7.7,9.72-7.7,4.9,0,8.64,2.8,9.51,7.7ZM19.3,23a9.84,9.84,0,0,1,9.5,7h9.14c-1.65-8.93-9-15-18.57-15A19,19,0,0,0,0,34.34c0,11.09,8.28,19.3,19.37,19.3,9.36,0,16.85-6,18.5-15H28.8a9.75,9.75,0,0,1-9.43,7.06c-6.27,0-10.66-4.83-10.66-11.31S13,23,19.3,23Zm41.11-8A19,19,0,0,0,41,34.34c0,11.09,8.28,19.3,19.37,19.3A19,19,0,0,0,79.92,34.27C79.92,23.33,71.64,15,60.41,15Zm.07,30.67c-6.19,0-10.73-4.83-10.73-11.31S54.22,23,60.41,23s10.8,4.89,10.8,11.37S66.67,45.65,60.48,45.65ZM123.41,15c-5.62,0-9.29,2.3-11.45,5.54V15.7h-8.57V52.92H112V32.69C112,27,115.63,23,121,23c5,0,8.06,3.53,8.06,8.64V52.92h8.64V31C137.66,21.6,132.84,15,123.41,15ZM92,.36a5.36,5.36,0,0,0-5.55,5.47,5.55,5.55,0,0,0,11.09,0A5.35,5.35,0,0,0,92,.36Zm-9.72,23h5.4V52.92h8.64V15.7h-14Zm298.17-7.7L366.2,52.92H372L375.29,44H392l3.33,8.88h6L386.87,15.7ZM377,39.23l6.45-17.56h.1l6.56,17.56ZM362.66,15.7l-7.88,29h-.11l-8.14-29H341l-8,28.93h-.1l-8-28.87H319L329.82,53h5.45l8.19-29.24h.11L352,53h5.66L368.1,15.7Zm135.25,0v4.86h12.32V52.92h5.6V20.56h12.32V15.7ZM467.82,52.92h25.54V48.06H473.43v-12h18.35V31.35H473.43V20.56h19.93V15.7H467.82ZM443,15.7h-5.6V52.92h24.32V48.06H443Zm-30.45,0h-5.61V52.92h24.32V48.06H412.52Z'/%3E%3C/svg%3E`;case"textWithLogo":return n=(.25*e).toFixed(2),`data:image/svg+xml,%3Csvg width='${e}' height='${n}' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 308.44 77.61'%3E%3Cdefs%3E%3Cstyle%3E.cls-1%7Bfill:%230052ff;%7D%3C/style%3E%3C/defs%3E%3Cpath class='cls-1' d='M142.94,20.2l-7.88,29H135l-8.15-29h-5.55l-8,28.93h-.11l-8-28.87H99.27l10.84,37.27h5.44l8.2-29.24h.1l8.41,29.24h5.66L148.39,20.2Zm17.82,0L146.48,57.42h5.82l3.28-8.88h16.65l3.34,8.88h6L167.16,20.2Zm-3.44,23.52,6.45-17.55h.11l6.56,17.55ZM278.2,20.2v4.86h12.32V57.42h5.6V25.06h12.32V20.2ZM248.11,57.42h25.54V52.55H253.71V40.61h18.35V35.85H253.71V25.06h19.94V20.2H248.11ZM223.26,20.2h-5.61V57.42H242V52.55H223.26Zm-30.46,0h-5.6V57.42h24.32V52.55H192.8Zm-154,38A19.41,19.41,0,1,1,57.92,35.57H77.47a38.81,38.81,0,1,0,0,6.47H57.92A19.39,19.39,0,0,1,38.81,58.21Z'/%3E%3C/svg%3E`;case"textLight":return n=(.1*e).toFixed(2),`data:image/svg+xml,%3Csvg width='${e}' height='${n}' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 528.15 53.64'%3E%3Cdefs%3E%3Cstyle%3E.cls-1%7Bfill:%23fefefe;%7D%3C/style%3E%3C/defs%3E%3Ctitle%3ECoinbase_Wordmark_SubBrands_ALL%3C/title%3E%3Cpath class='cls-1' d='M164.45,15a15,15,0,0,0-11.74,5.4V0h-8.64V52.92h8.5V48a15,15,0,0,0,11.88,5.62c10.37,0,18.21-8.21,18.21-19.3S174.67,15,164.45,15Zm-1.3,30.67c-6.19,0-10.73-4.83-10.73-11.31S157,23,163.22,23s10.66,4.82,10.66,11.37S169.34,45.65,163.15,45.65Zm83.31-14.91-6.34-.93c-3-.43-5.18-1.44-5.18-3.82,0-2.59,2.8-3.89,6.62-3.89,4.18,0,6.84,1.8,7.42,4.76h8.35c-.94-7.49-6.7-11.88-15.55-11.88-9.15,0-15.2,4.68-15.2,11.3,0,6.34,4,10,12,11.16l6.33.94c3.1.43,4.83,1.65,4.83,4,0,2.95-3,4.17-7.2,4.17-5.12,0-8-2.09-8.43-5.25h-8.49c.79,7.27,6.48,12.38,16.84,12.38,9.44,0,15.7-4.32,15.7-11.74C258.12,35.28,253.58,31.82,246.46,30.74Zm-27.65-2.3c0-8.06-4.9-13.46-15.27-13.46-9.79,0-15.26,5-16.34,12.6h8.57c.43-3,2.73-5.4,7.63-5.4,4.39,0,6.55,1.94,6.55,4.32,0,3.09-4,3.88-8.85,4.39-6.63.72-14.84,3-14.84,11.66,0,6.7,5,11,12.89,11,6.19,0,10.08-2.59,12-6.7.28,3.67,3,6.05,6.84,6.05h5v-7.7h-4.25Zm-8.5,9.36c0,5-4.32,8.64-9.57,8.64-3.24,0-6-1.37-6-4.25,0-3.67,4.39-4.68,8.42-5.11s6-1.22,7.13-2.88ZM281.09,15c-11.09,0-19.23,8.35-19.23,19.36,0,11.6,8.72,19.3,19.37,19.3,9,0,16.06-5.33,17.86-12.89h-9c-1.3,3.31-4.47,5.19-8.71,5.19-5.55,0-9.72-3.46-10.66-9.51H299.3V33.12C299.3,22.46,291.53,15,281.09,15Zm-9.87,15.26c1.37-5.18,5.26-7.7,9.72-7.7,4.9,0,8.64,2.8,9.51,7.7ZM19.3,23a9.84,9.84,0,0,1,9.5,7h9.14c-1.65-8.93-9-15-18.57-15A19,19,0,0,0,0,34.34c0,11.09,8.28,19.3,19.37,19.3,9.36,0,16.85-6,18.5-15H28.8a9.75,9.75,0,0,1-9.43,7.06c-6.27,0-10.66-4.83-10.66-11.31S13,23,19.3,23Zm41.11-8A19,19,0,0,0,41,34.34c0,11.09,8.28,19.3,19.37,19.3A19,19,0,0,0,79.92,34.27C79.92,23.33,71.64,15,60.41,15Zm.07,30.67c-6.19,0-10.73-4.83-10.73-11.31S54.22,23,60.41,23s10.8,4.89,10.8,11.37S66.67,45.65,60.48,45.65ZM123.41,15c-5.62,0-9.29,2.3-11.45,5.54V15.7h-8.57V52.92H112V32.69C112,27,115.63,23,121,23c5,0,8.06,3.53,8.06,8.64V52.92h8.64V31C137.66,21.6,132.84,15,123.41,15ZM92,.36a5.36,5.36,0,0,0-5.55,5.47,5.55,5.55,0,0,0,11.09,0A5.35,5.35,0,0,0,92,.36Zm-9.72,23h5.4V52.92h8.64V15.7h-14Zm298.17-7.7L366.2,52.92H372L375.29,44H392l3.33,8.88h6L386.87,15.7ZM377,39.23l6.45-17.56h.1l6.56,17.56ZM362.66,15.7l-7.88,29h-.11l-8.14-29H341l-8,28.93h-.1l-8-28.87H319L329.82,53h5.45l8.19-29.24h.11L352,53h5.66L368.1,15.7Zm135.25,0v4.86h12.32V52.92h5.6V20.56h12.32V15.7ZM467.82,52.92h25.54V48.06H473.43v-12h18.35V31.35H473.43V20.56h19.93V15.7H467.82ZM443,15.7h-5.6V52.92h24.32V48.06H443Zm-30.45,0h-5.61V52.92h24.32V48.06H412.52Z'/%3E%3C/svg%3E`;case"textWithLogoLight":return n=(.25*e).toFixed(2),`data:image/svg+xml,%3Csvg width='${e}' height='${n}' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 308.44 77.61'%3E%3Cdefs%3E%3Cstyle%3E.cls-1%7Bfill:%23fefefe;%7D%3C/style%3E%3C/defs%3E%3Cpath class='cls-1' d='M142.94,20.2l-7.88,29H135l-8.15-29h-5.55l-8,28.93h-.11l-8-28.87H99.27l10.84,37.27h5.44l8.2-29.24h.1l8.41,29.24h5.66L148.39,20.2Zm17.82,0L146.48,57.42h5.82l3.28-8.88h16.65l3.34,8.88h6L167.16,20.2Zm-3.44,23.52,6.45-17.55h.11l6.56,17.55ZM278.2,20.2v4.86h12.32V57.42h5.6V25.06h12.32V20.2ZM248.11,57.42h25.54V52.55H253.71V40.61h18.35V35.85H253.71V25.06h19.94V20.2H248.11ZM223.26,20.2h-5.61V57.42H242V52.55H223.26Zm-30.46,0h-5.6V57.42h24.32V52.55H192.8Zm-154,38A19.41,19.41,0,1,1,57.92,35.57H77.47a38.81,38.81,0,1,0,0,6.47H57.92A19.39,19.39,0,0,1,38.81,58.21Z'/%3E%3C/svg%3E`;default:return n=e,`data:image/svg+xml,%3Csvg width='${e}' height='${n}' viewBox='0 0 1024 1024' fill='none' xmlns='http://www.w3.org/2000/svg'%3E %3Crect width='1024' height='1024' fill='%230052FF'/%3E %3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M152 512C152 710.823 313.177 872 512 872C710.823 872 872 710.823 872 512C872 313.177 710.823 152 512 152C313.177 152 152 313.177 152 512ZM420 396C406.745 396 396 406.745 396 420V604C396 617.255 406.745 628 420 628H604C617.255 628 628 617.255 628 604V420C628 406.745 617.255 396 604 396H420Z' fill='white'/%3E %3C/svg%3E `}};function pt(t,{strict:e=!0}={}){return!t||typeof t!="string"?!1:e?/^0x[0-9a-fA-F]*$/.test(t):t.startsWith("0x")}function Lt(t){return pt(t,{strict:!1})?Math.ceil((t.length-2)/2):t.length}const En="2.37.2";let $e={getDocsUrl:({docsBaseUrl:t,docsPath:e="",docsSlug:n})=>e?`${t??"https://viem.sh"}${e}${n?`#${n}`:""}`:void 0,version:`viem@${En}`};class oe extends Error{constructor(e,n={}){const s=n.cause instanceof oe?n.cause.details:n.cause?.message?n.cause.message:n.details,i=n.cause instanceof oe&&n.cause.docsPath||n.docsPath,r=$e.getDocsUrl?.({...n,docsPath:i}),o=[e||"An error occurred.","",...n.metaMessages?[...n.metaMessages,""]:[],...r?[`Docs: ${r}`]:[],...s?[`Details: ${s}`]:[],...$e.version?[`Version: ${$e.version}`]:[]].join(`
`);super(o,n.cause?{cause:n.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=s,this.docsPath=i,this.metaMessages=n.metaMessages,this.name=n.name??this.name,this.shortMessage=e,this.version=En}walk(e){return In(this,e)}}function In(t,e){return e?.(t)?t:t&&typeof t=="object"&&"cause"in t&&t.cause!==void 0?In(t.cause,e):e?null:t}class xn extends oe{constructor({size:e,targetSize:n,type:s}){super(`${s.charAt(0).toUpperCase()}${s.slice(1).toLowerCase()} size (${e}) exceeds padding size (${n}).`,{name:"SizeExceedsPaddingSizeError"})}}function Ue(t,{dir:e,size:n=32}={}){return typeof t=="string"?ks(t,{dir:e,size:n}):Es(t,{dir:e,size:n})}function ks(t,{dir:e,size:n=32}={}){if(n===null)return t;const s=t.replace("0x","");if(s.length>n*2)throw new xn({size:Math.ceil(s.length/2),targetSize:n,type:"hex"});return`0x${s[e==="right"?"padEnd":"padStart"](n*2,"0")}`}function Es(t,{dir:e,size:n=32}={}){if(n===null)return t;if(t.length>n)throw new xn({size:t.length,targetSize:n,type:"bytes"});const s=new Uint8Array(n);for(let i=0;i<n;i++){const r=e==="right";s[r?i:n-i-1]=t[r?i:t.length-i-1]}return s}class Is extends oe{constructor({max:e,min:n,signed:s,size:i,value:r}){super(`Number "${r}" is not in safe ${i?`${i*8}-bit ${s?"signed":"unsigned"} `:""}integer range ${e?`(${n} to ${e})`:`(above ${n})`}`,{name:"IntegerOutOfRangeError"})}}class xs extends oe{constructor({givenSize:e,maxSize:n}){super(`Size cannot exceed ${n} bytes. Given size: ${e} bytes.`,{name:"SizeOverflowError"})}}function He(t,{size:e}){if(Lt(t)>e)throw new xs({givenSize:Lt(t),maxSize:e})}function Cs(t,e={}){const{signed:n}=e;e.size&&He(t,{size:e.size});const s=BigInt(t);if(!n)return s;const i=(t.length-2)/2,r=(1n<<BigInt(i)*8n-1n)-1n;return s<=r?s:s-BigInt(`0x${"f".padStart(i*2,"f")}`)-1n}function Mt(t,e={}){return Number(Cs(t,e))}function Ss(t,e={}){const{signed:n,size:s}=e,i=BigInt(t);let r;s?n?r=(1n<<BigInt(s)*8n-1n)-1n:r=2n**(BigInt(s)*8n)-1n:typeof t=="number"&&(r=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof r=="bigint"&&n?-r-1n:0;if(r&&i>r||i<o){const d=typeof t=="bigint"?"n":"";throw new Is({max:r?`${r}${d}`:void 0,min:`${o}${d}`,signed:n,size:s,value:`${t}${d}`})}const a=`0x${(n&&i<0?(1n<<BigInt(s*8))+BigInt(i):i).toString(16)}`;return s?Ue(a,{size:s}):a}const As=new TextEncoder;function Ls(t,e={}){return typeof t=="number"||typeof t=="bigint"?Ps(t,e):typeof t=="boolean"?Ms(t,e):pt(t)?Cn(t,e):Sn(t,e)}function Ms(t,e={}){const n=new Uint8Array(1);return n[0]=Number(t),typeof e.size=="number"?(He(n,{size:e.size}),Ue(n,{size:e.size})):n}const Q={zero:48,nine:57,A:65,F:70,a:97,f:102};function Pt(t){if(t>=Q.zero&&t<=Q.nine)return t-Q.zero;if(t>=Q.A&&t<=Q.F)return t-(Q.A-10);if(t>=Q.a&&t<=Q.f)return t-(Q.a-10)}function Cn(t,e={}){let n=t;e.size&&(He(n,{size:e.size}),n=Ue(n,{dir:"right",size:e.size}));let s=n.slice(2);s.length%2&&(s=`0${s}`);const i=s.length/2,r=new Uint8Array(i);for(let o=0,a=0;o<i;o++){const d=Pt(s.charCodeAt(a++)),u=Pt(s.charCodeAt(a++));if(d===void 0||u===void 0)throw new oe(`Invalid byte sequence ("${s[a-2]}${s[a-1]}" in "${s}").`);r[o]=d*16+u}return r}function Ps(t,e){const n=Ss(t,e);return Cn(n)}function Sn(t,e={}){const n=As.encode(t);return typeof e.size=="number"?(He(n,{size:e.size}),Ue(n,{dir:"right",size:e.size})):n}const Ce=BigInt(2**32-1),Tt=BigInt(32);function Ts(t,e=!1){return e?{h:Number(t&Ce),l:Number(t>>Tt&Ce)}:{h:Number(t>>Tt&Ce)|0,l:Number(t&Ce)|0}}function Os(t,e=!1){const n=t.length;let s=new Uint32Array(n),i=new Uint32Array(n);for(let r=0;r<n;r++){const{h:o,l:a}=Ts(t[r],e);[s[r],i[r]]=[o,a]}return[s,i]}const Rs=(t,e,n)=>t<<n|e>>>32-n,Ns=(t,e,n)=>e<<n|t>>>32-n,Ds=(t,e,n)=>e<<n-32|t>>>64-n,Us=(t,e,n)=>t<<n-32|e>>>64-n;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Hs(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Ot(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function pe(t,...e){if(!Hs(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function Re(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function An(t,e){pe(t);const n=e.outputLen;if(t.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function Bs(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function ke(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function ze(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Z(t,e){return t<<32-e|t>>>e}const js=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function Ws(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}function qs(t){for(let e=0;e<t.length;e++)t[e]=Ws(t[e]);return t}const Rt=js?t=>t:qs,$s=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",zs=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Vs(t){if(pe(t),$s)return t.toHex();let e="";for(let n=0;n<t.length;n++)e+=zs[t[n]];return e}function Fs(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function gt(t){return typeof t=="string"&&(t=Fs(t)),pe(t),t}class Ln{}function Mn(t){const e=s=>t().update(gt(s)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}const Ks=BigInt(0),me=BigInt(1),Zs=BigInt(2),Gs=BigInt(7),Ys=BigInt(256),Js=BigInt(113),Pn=[],Tn=[],On=[];for(let t=0,e=me,n=1,s=0;t<24;t++){[n,s]=[s,(2*n+3*s)%5],Pn.push(2*(5*s+n)),Tn.push((t+1)*(t+2)/2%64);let i=Ks;for(let r=0;r<7;r++)e=(e<<me^(e>>Gs)*Js)%Ys,e&Zs&&(i^=me<<(me<<BigInt(r))-me);On.push(i)}const Rn=Os(On,!0),Qs=Rn[0],Xs=Rn[1],Nt=(t,e,n)=>n>32?Ds(t,e,n):Rs(t,e,n),Dt=(t,e,n)=>n>32?Us(t,e,n):Ns(t,e,n);function ei(t,e=24){const n=new Uint32Array(10);for(let s=24-e;s<24;s++){for(let o=0;o<10;o++)n[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,d=(o+2)%10,u=n[d],p=n[d+1],c=Nt(u,p,1)^n[a],h=Dt(u,p,1)^n[a+1];for(let l=0;l<50;l+=10)t[o+l]^=c,t[o+l+1]^=h}let i=t[2],r=t[3];for(let o=0;o<24;o++){const a=Tn[o],d=Nt(i,r,a),u=Dt(i,r,a),p=Pn[o];i=t[p],r=t[p+1],t[p]=d,t[p+1]=u}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)n[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~n[(a+2)%10]&n[(a+4)%10]}t[0]^=Qs[s],t[1]^=Xs[s]}ke(n)}class mt extends Ln{constructor(e,n,s,i=!1,r=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=n,this.outputLen=s,this.enableXOF=i,this.rounds=r,Ot(s),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=Bs(this.state)}clone(){return this._cloneInto()}keccak(){Rt(this.state32),ei(this.state32,this.rounds),Rt(this.state32),this.posOut=0,this.pos=0}update(e){Re(this),e=gt(e),pe(e);const{blockLen:n,state:s}=this,i=e.length;for(let r=0;r<i;){const o=Math.min(n-this.pos,i-r);for(let a=0;a<o;a++)s[this.pos++]^=e[r++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:n,pos:s,blockLen:i}=this;e[s]^=n,(n&128)!==0&&s===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){Re(this,!1),pe(e),this.finish();const n=this.state,{blockLen:s}=this;for(let i=0,r=e.length;i<r;){this.posOut>=s&&this.keccak();const o=Math.min(s-this.posOut,r-i);e.set(n.subarray(this.posOut,this.posOut+o),i),this.posOut+=o,i+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Ot(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(An(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,ke(this.state)}_cloneInto(e){const{blockLen:n,suffix:s,outputLen:i,rounds:r,enableXOF:o}=this;return e||(e=new mt(n,s,i,o,r)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=r,e.suffix=s,e.outputLen=i,e.enableXOF=o,e.destroyed=this.destroyed,e}}const ti=(t,e,n)=>Mn(()=>new mt(e,t,n)),ni=ti(1,136,256/8);function si(t,e){return ni(pt(t,{strict:!1})?Ls(t):t)}class Ut extends oe{constructor({address:e}){super(`Address "${e}" is invalid.`,{metaMessages:["- Address must be a hex value of 20 bytes (40 hex characters).","- Address must match its checksum counterpart."],name:"InvalidAddressError"})}}class Nn extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const n=super.get(e);return super.has(e)&&n!==void 0&&(this.delete(e),super.set(e,n)),n}set(e,n){if(super.set(e,n),this.maxSize&&this.size>this.maxSize){const s=this.keys().next().value;s&&this.delete(s)}return this}}const Ve=new Nn(8192);function ii(t,e){if(Ve.has(`${t}.${e}`))return Ve.get(`${t}.${e}`);const n=t.substring(2).toLowerCase(),s=si(Sn(n)),i=n.split("");for(let o=0;o<40;o+=2)s[o>>1]>>4>=8&&i[o]&&(i[o]=i[o].toUpperCase()),(s[o>>1]&15)>=8&&i[o+1]&&(i[o+1]=i[o+1].toUpperCase());const r=`0x${i.join("")}`;return Ve.set(`${t}.${e}`,r),r}const ri=/^0x[a-fA-F0-9]{40}$/,Fe=new Nn(8192);function st(t,e){const{strict:n=!0}=e??{},s=`${t}.${n}`;if(Fe.has(s))return Fe.get(s);const i=ri.test(t)?t.toLowerCase()===t?!0:n?ii(t)===t:!0:!1;return Fe.set(s,i),i}function oi(t,e,n,s){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,s);const i=BigInt(32),r=BigInt(4294967295),o=Number(n>>i&r),a=Number(n&r),d=s?4:0,u=s?0:4;t.setUint32(e+d,o,s),t.setUint32(e+u,a,s)}function ai(t,e,n){return t&e^~t&n}function ci(t,e,n){return t&e^t&n^e&n}class li extends Ln{constructor(e,n,s,i){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=n,this.padOffset=s,this.isLE=i,this.buffer=new Uint8Array(e),this.view=ze(this.buffer)}update(e){Re(this),e=gt(e),pe(e);const{view:n,buffer:s,blockLen:i}=this,r=e.length;for(let o=0;o<r;){const a=Math.min(i-this.pos,r-o);if(a===i){const d=ze(e);for(;i<=r-o;o+=i)this.process(d,o);continue}s.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===i&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Re(this),An(e,this),this.finished=!0;const{buffer:n,view:s,blockLen:i,isLE:r}=this;let{pos:o}=this;n[o++]=128,ke(this.buffer.subarray(o)),this.padOffset>i-o&&(this.process(s,0),o=0);for(let c=o;c<i;c++)n[c]=0;oi(s,i-8,BigInt(this.length*8),r),this.process(s,0);const a=ze(e),d=this.outputLen;if(d%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=d/4,p=this.get();if(u>p.length)throw new Error("_sha2: outputLen bigger than state");for(let c=0;c<u;c++)a.setUint32(4*c,p[c],r)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const s=e.slice(0,n);return this.destroy(),s}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:s,length:i,finished:r,destroyed:o,pos:a}=this;return e.destroyed=o,e.finished=r,e.length=i,e.pos=a,i%n&&e.buffer.set(s),e}clone(){return this._cloneInto()}}const ne=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),ui=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),se=new Uint32Array(64);class di extends li{constructor(e=32){super(64,e,8,!1),this.A=ne[0]|0,this.B=ne[1]|0,this.C=ne[2]|0,this.D=ne[3]|0,this.E=ne[4]|0,this.F=ne[5]|0,this.G=ne[6]|0,this.H=ne[7]|0}get(){const{A:e,B:n,C:s,D:i,E:r,F:o,G:a,H:d}=this;return[e,n,s,i,r,o,a,d]}set(e,n,s,i,r,o,a,d){this.A=e|0,this.B=n|0,this.C=s|0,this.D=i|0,this.E=r|0,this.F=o|0,this.G=a|0,this.H=d|0}process(e,n){for(let c=0;c<16;c++,n+=4)se[c]=e.getUint32(n,!1);for(let c=16;c<64;c++){const h=se[c-15],l=se[c-2],f=Z(h,7)^Z(h,18)^h>>>3,k=Z(l,17)^Z(l,19)^l>>>10;se[c]=k+se[c-7]+f+se[c-16]|0}let{A:s,B:i,C:r,D:o,E:a,F:d,G:u,H:p}=this;for(let c=0;c<64;c++){const h=Z(a,6)^Z(a,11)^Z(a,25),l=p+h+ai(a,d,u)+ui[c]+se[c]|0,k=(Z(s,2)^Z(s,13)^Z(s,22))+ci(s,i,r)|0;p=u,u=d,d=a,a=o+l|0,o=r,r=i,i=s,s=l+k|0}s=s+this.A|0,i=i+this.B|0,r=r+this.C|0,o=o+this.D|0,a=a+this.E|0,d=d+this.F|0,u=u+this.G|0,p=p+this.H|0,this.set(s,i,r,o,a,d,u,p)}roundClean(){ke(se)}destroy(){this.set(0,0,0,0,0,0,0,0),ke(this.buffer)}}const hi=Mn(()=>new di),fi=hi;function pi(t,e){if(!st(t,{strict:!1}))throw new Ut({address:t});if(!st(e,{strict:!1}))throw new Ut({address:e});return t.toLowerCase()===e.toLowerCase()}class J{constructor(e,n){this.scope=e,this.module=n}storeObject(e,n){this.setItem(e,JSON.stringify(n))}loadObject(e){const n=this.getItem(e);return n?JSON.parse(n):void 0}setItem(e,n){localStorage.setItem(this.scopedKey(e),n)}getItem(e){return localStorage.getItem(this.scopedKey(e))}removeItem(e){localStorage.removeItem(this.scopedKey(e))}clear(){const e=this.scopedKey(""),n=[];for(let s=0;s<localStorage.length;s++){const i=localStorage.key(s);typeof i=="string"&&i.startsWith(e)&&n.push(i)}n.forEach(s=>localStorage.removeItem(s))}scopedKey(e){return`-${this.scope}${this.module?`:${this.module}`:""}:${e}`}static clearAll(){new J("CBWSDK").clear(),new J("walletlink").clear()}}const H={rpc:{invalidInput:-32e3,resourceNotFound:-32001,resourceUnavailable:-32002,transactionRejected:-32003,methodNotSupported:-32004,limitExceeded:-32005,parse:-32700,invalidRequest:-32600,methodNotFound:-32601,invalidParams:-32602,internal:-32603},provider:{userRejectedRequest:4001,unauthorized:4100,unsupportedMethod:4200,disconnected:4900,chainDisconnected:4901,unsupportedChain:4902}},it={"-32700":{standard:"JSON RPC 2.0",message:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."},"-32600":{standard:"JSON RPC 2.0",message:"The JSON sent is not a valid Request object."},"-32601":{standard:"JSON RPC 2.0",message:"The method does not exist / is not available."},"-32602":{standard:"JSON RPC 2.0",message:"Invalid method parameter(s)."},"-32603":{standard:"JSON RPC 2.0",message:"Internal JSON-RPC error."},"-32000":{standard:"EIP-1474",message:"Invalid input."},"-32001":{standard:"EIP-1474",message:"Resource not found."},"-32002":{standard:"EIP-1474",message:"Resource unavailable."},"-32003":{standard:"EIP-1474",message:"Transaction rejected."},"-32004":{standard:"EIP-1474",message:"Method not supported."},"-32005":{standard:"EIP-1474",message:"Request limit exceeded."},4001:{standard:"EIP-1193",message:"User rejected the request."},4100:{standard:"EIP-1193",message:"The requested account and/or method has not been authorized by the user."},4200:{standard:"EIP-1193",message:"The requested method is not supported by this Ethereum provider."},4900:{standard:"EIP-1193",message:"The provider is disconnected from all chains."},4901:{standard:"EIP-1193",message:"The provider is disconnected from the specified chain."},4902:{standard:"EIP-3085",message:"Unrecognized chain ID."}},Dn="Unspecified error message.",gi="Unspecified server error.";function _t(t,e=Dn){if(t&&Number.isInteger(t)){const n=t.toString();if(rt(it,n))return it[n].message;if(Un(t))return gi}return e}function mi(t){if(!Number.isInteger(t))return!1;const e=t.toString();return!!(it[e]||Un(t))}function _i(t,{shouldIncludeStack:e=!1}={}){const n={};if(t&&typeof t=="object"&&!Array.isArray(t)&&rt(t,"code")&&mi(t.code)){const s=t;n.code=s.code,s.message&&typeof s.message=="string"?(n.message=s.message,rt(s,"data")&&(n.data=s.data)):(n.message=_t(n.code),n.data={originalError:Ht(t)})}else n.code=H.rpc.internal,n.message=Bt(t,"message")?t.message:Dn,n.data={originalError:Ht(t)};return e&&(n.stack=Bt(t,"stack")?t.stack:void 0),n}function Un(t){return t>=-32099&&t<=-32e3}function Ht(t){return t&&typeof t=="object"&&!Array.isArray(t)?Object.assign({},t):t}function rt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Bt(t,e){return typeof t=="object"&&t!==null&&e in t&&typeof t[e]=="string"}const L={rpc:{parse:t=>K(H.rpc.parse,t),invalidRequest:t=>K(H.rpc.invalidRequest,t),invalidParams:t=>K(H.rpc.invalidParams,t),methodNotFound:t=>K(H.rpc.methodNotFound,t),internal:t=>K(H.rpc.internal,t),server:t=>{if(!t||typeof t!="object"||Array.isArray(t))throw new Error("Ethereum RPC Server errors must provide single object argument.");const{code:e}=t;if(!Number.isInteger(e)||e>-32005||e<-32099)throw new Error('"code" must be an integer such that: -32099 <= code <= -32005');return K(e,t)},invalidInput:t=>K(H.rpc.invalidInput,t),resourceNotFound:t=>K(H.rpc.resourceNotFound,t),resourceUnavailable:t=>K(H.rpc.resourceUnavailable,t),transactionRejected:t=>K(H.rpc.transactionRejected,t),methodNotSupported:t=>K(H.rpc.methodNotSupported,t),limitExceeded:t=>K(H.rpc.limitExceeded,t)},provider:{userRejectedRequest:t=>he(H.provider.userRejectedRequest,t),unauthorized:t=>he(H.provider.unauthorized,t),unsupportedMethod:t=>he(H.provider.unsupportedMethod,t),disconnected:t=>he(H.provider.disconnected,t),chainDisconnected:t=>he(H.provider.chainDisconnected,t),unsupportedChain:t=>he(H.provider.unsupportedChain,t),custom:t=>{if(!t||typeof t!="object"||Array.isArray(t))throw new Error("Ethereum Provider custom errors must provide single object argument.");const{code:e,message:n,data:s}=t;if(!n||typeof n!="string")throw new Error('"message" must be a nonempty string');return new jn(e,n,s)}}};function K(t,e){const[n,s]=Hn(e);return new Bn(t,n||_t(t),s)}function he(t,e){const[n,s]=Hn(e);return new jn(t,n||_t(t),s)}function Hn(t){if(t){if(typeof t=="string")return[t];if(typeof t=="object"&&!Array.isArray(t)){const{message:e,data:n}=t;if(e&&typeof e!="string")throw new Error("Must specify string message.");return[e||void 0,n]}}return[]}class Bn extends Error{constructor(e,n,s){if(!Number.isInteger(e))throw new Error('"code" must be an integer.');if(!n||typeof n!="string")throw new Error('"message" must be a nonempty string.');super(n),this.code=e,s!==void 0&&(this.data=s)}}class jn extends Bn{constructor(e,n,s){if(!bi(e))throw new Error('"code" must be an integer such that: 1000 <= code <= 4999');super(e,n,s)}}function bi(t){return Number.isInteger(t)&&t>=1e3&&t<=4999}function bt(){return t=>t}const Ee=bt(),yi=bt(),wi=bt();function X(t){return Math.floor(t)}const Wn=/^[0-9]*$/,qn=/^[a-f0-9]*$/;function ce(t){return yt(crypto.getRandomValues(new Uint8Array(t)))}function yt(t){return[...t].map(e=>e.toString(16).padStart(2,"0")).join("")}function Me(t){return new Uint8Array(t.match(/.{1,2}/g).map(e=>Number.parseInt(e,16)))}function ye(t,e=!1){const n=t.toString("hex");return Ee(e?`0x${n}`:n)}function Ke(t){return ye(ot(t),!0)}function G(t){return wi(t.toString(10))}function re(t){return Ee(`0x${BigInt(t).toString(16)}`)}function $n(t){return t.startsWith("0x")||t.startsWith("0X")}function wt(t){return $n(t)?t.slice(2):t}function zn(t){return $n(t)?`0x${t.slice(2)}`:`0x${t}`}function Be(t){if(typeof t!="string")return!1;const e=wt(t).toLowerCase();return qn.test(e)}function vi(t,e=!1){if(typeof t=="string"){const n=wt(t).toLowerCase();if(qn.test(n))return Ee(e?`0x${n}`:n)}throw L.rpc.invalidParams(`"${String(t)}" is not a hexadecimal string`)}function vt(t,e=!1){let n=vi(t,!1);return n.length%2===1&&(n=Ee(`0${n}`)),e?Ee(`0x${n}`):n}function ie(t){if(typeof t=="string"){const e=wt(t).toLowerCase();if(Be(e)&&e.length===40)return yi(zn(e))}throw L.rpc.invalidParams(`Invalid Ethereum address: ${String(t)}`)}function ot(t){if(Buffer.isBuffer(t))return t;if(typeof t=="string"){if(Be(t)){const e=vt(t,!1);return Buffer.from(e,"hex")}return Buffer.from(t,"utf8")}throw L.rpc.invalidParams(`Not binary data: ${String(t)}`)}function we(t){if(typeof t=="number"&&Number.isInteger(t))return X(t);if(typeof t=="string"){if(Wn.test(t))return X(Number(t));if(Be(t))return X(Number(BigInt(vt(t,!0))))}throw L.rpc.invalidParams(`Not an integer: ${String(t)}`)}function _e(t){if(t!==null&&(typeof t=="bigint"||Ei(t)))return BigInt(t.toString(10));if(typeof t=="number")return BigInt(we(t));if(typeof t=="string"){if(Wn.test(t))return BigInt(t);if(Be(t))return BigInt(vt(t,!0))}throw L.rpc.invalidParams(`Not an integer: ${String(t)}`)}function ki(t){if(typeof t=="string")return JSON.parse(t);if(typeof t=="object")return t;throw L.rpc.invalidParams(`Not a JSON string or an object: ${String(t)}`)}function Ei(t){if(t==null||typeof t.constructor!="function")return!1;const{constructor:e}=t;return typeof e.config=="function"&&typeof e.EUCLID=="number"}function Ii(){const t=document.querySelector('link[sizes="192x192"]')||document.querySelector('link[sizes="180x180"]')||document.querySelector('link[rel="icon"]')||document.querySelector('link[rel="shortcut icon"]'),{protocol:e,host:n}=document.location,s=t?t.getAttribute("href"):null;return!s||s.startsWith("javascript:")||s.startsWith("vbscript:")?`${e}//${n}/favicon.ico`:s.startsWith("http://")||s.startsWith("https://")||s.startsWith("data:")?s:s.startsWith("//")?e+s:`${e}//${n}${s}`}async function xi(){return crypto.subtle.generateKey({name:"ECDH",namedCurve:"P-256"},!0,["deriveKey"])}async function Ci(t,e){return crypto.subtle.deriveKey({name:"ECDH",public:e},t,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}async function Si(t,e){const n=crypto.getRandomValues(new Uint8Array(12)),s=await crypto.subtle.encrypt({name:"AES-GCM",iv:n},t,new TextEncoder().encode(e));return{iv:n,cipherText:s}}async function Ai(t,{iv:e,cipherText:n}){const s=await crypto.subtle.decrypt({name:"AES-GCM",iv:e},t,n);return new TextDecoder().decode(s)}function Vn(t){switch(t){case"public":return"spki";case"private":return"pkcs8"}}async function Fn(t,e){const n=Vn(t),s=await crypto.subtle.exportKey(n,e);return yt(new Uint8Array(s))}async function Kn(t,e){const n=Vn(t),s=Me(e).buffer;return await crypto.subtle.importKey(n,new Uint8Array(s),{name:"ECDH",namedCurve:"P-256"},!0,t==="private"?["deriveKey"]:[])}async function Li(t,e){const n=JSON.stringify(t,(s,i)=>{if(!(i instanceof Error))return i;const r=i;return Object.assign(Object.assign({},r.code?{code:r.code}:{}),{message:r.message})});return Si(e,n)}async function Mi(t,e){return JSON.parse(await Ai(e,t))}const Ze={storageKey:"ownPrivateKey",keyType:"private"},Ge={storageKey:"ownPublicKey",keyType:"public"},Ye={storageKey:"peerPublicKey",keyType:"public"};class Pi{constructor(){this.storage=new J("CBWSDK","SCWKeyManager"),this.ownPrivateKey=null,this.ownPublicKey=null,this.peerPublicKey=null,this.sharedSecret=null}async getOwnPublicKey(){return await this.loadKeysIfNeeded(),this.ownPublicKey}async getSharedSecret(){return await this.loadKeysIfNeeded(),this.sharedSecret}async setPeerPublicKey(e){this.sharedSecret=null,this.peerPublicKey=e,await this.storeKey(Ye,e),await this.loadKeysIfNeeded()}async clear(){this.ownPrivateKey=null,this.ownPublicKey=null,this.peerPublicKey=null,this.sharedSecret=null,this.storage.removeItem(Ge.storageKey),this.storage.removeItem(Ze.storageKey),this.storage.removeItem(Ye.storageKey)}async generateKeyPair(){const e=await xi();this.ownPrivateKey=e.privateKey,this.ownPublicKey=e.publicKey,await this.storeKey(Ze,e.privateKey),await this.storeKey(Ge,e.publicKey)}async loadKeysIfNeeded(){if(this.ownPrivateKey===null&&(this.ownPrivateKey=await this.loadKey(Ze)),this.ownPublicKey===null&&(this.ownPublicKey=await this.loadKey(Ge)),(this.ownPrivateKey===null||this.ownPublicKey===null)&&await this.generateKeyPair(),this.peerPublicKey===null&&(this.peerPublicKey=await this.loadKey(Ye)),this.sharedSecret===null){if(this.ownPrivateKey===null||this.peerPublicKey===null)return;this.sharedSecret=await Ci(this.ownPrivateKey,this.peerPublicKey)}}async loadKey(e){const n=this.storage.getItem(e.storageKey);return n?Kn(e.keyType,n):null}async storeKey(e,n){const s=await Fn(e.keyType,n);this.storage.setItem(e.storageKey,s)}}function Ti(t){if(!t||!Array.isArray(t)||t.length!==1&&t.length!==2||typeof t[0]!="string"||!st(t[0]))throw L.rpc.invalidParams();if(t.length===2){if(!Array.isArray(t[1]))throw L.rpc.invalidParams();for(const e of t[1])if(typeof e!="string"||!e.startsWith("0x"))throw L.rpc.invalidParams()}}const xe="4.3.7",Zn="@coinbase/wallet-sdk";async function kt(t,e){const n=Object.assign(Object.assign({},t),{jsonrpc:"2.0",id:crypto.randomUUID()}),s=await window.fetch(e,{method:"POST",body:JSON.stringify(n),mode:"cors",headers:{"Content-Type":"application/json","X-Cbw-Sdk-Version":xe,"X-Cbw-Sdk-Platform":Zn}}),{result:i,error:r}=await s.json();if(r)throw r;return i}function Oi(){return globalThis.coinbaseWalletExtension}function Ri(){var t,e;try{const n=globalThis;return(e=(t=n.top)===null||t===void 0?void 0:t.ethereum)!==null&&e!==void 0?e:n.ethereum}catch{return}}function Ni({metadata:t,preference:e}){var n,s;const{appName:i,appLogoUrl:r,appChainIds:o}=t;if(e.options!=="smartWalletOnly"){const d=Oi();if(d)return(n=d.setAppInfo)===null||n===void 0||n.call(d,i,r,o,e),d}const a=Ri();if(a?.isCoinbaseBrowser)return(s=a.setAppInfo)===null||s===void 0||s.call(a,i,r,o,e),a}function Di(t){if(!t||typeof t!="object"||Array.isArray(t))throw L.rpc.invalidParams({message:"Expected a single, non-array, object argument.",data:t});const{method:e,params:n}=t;if(typeof e!="string"||e.length===0)throw L.rpc.invalidParams({message:"'args.method' must be a non-empty string.",data:t});if(n!==void 0&&!Array.isArray(n)&&(typeof n!="object"||n===null))throw L.rpc.invalidParams({message:"'args.params' must be an object or array if provided.",data:t});switch(e){case"eth_sign":case"eth_signTypedData_v2":case"eth_subscribe":case"eth_unsubscribe":throw L.provider.unsupportedMethod()}}const jt="accounts",Wt="activeChain",qt="availableChains",$t="walletCapabilities";class Ui{constructor(e){var n,s,i;this.metadata=e.metadata,this.communicator=e.communicator,this.callback=e.callback,this.keyManager=new Pi,this.storage=new J("CBWSDK","SCWStateManager"),this.accounts=(n=this.storage.loadObject(jt))!==null&&n!==void 0?n:[],this.chain=this.storage.loadObject(Wt)||{id:(i=(s=e.metadata.appChainIds)===null||s===void 0?void 0:s[0])!==null&&i!==void 0?i:1},this.handshake=this.handshake.bind(this),this.request=this.request.bind(this),this.createRequestMessage=this.createRequestMessage.bind(this),this.decryptResponseMessage=this.decryptResponseMessage.bind(this)}async handshake(e){var n,s,i,r;await((s=(n=this.communicator).waitForPopupLoaded)===null||s===void 0?void 0:s.call(n));const o=await this.createRequestMessage({handshake:{method:e.method,params:Object.assign({},this.metadata,(i=e.params)!==null&&i!==void 0?i:{})}}),a=await this.communicator.postRequestAndWaitForResponse(o);if("failure"in a.content)throw a.content.failure;const d=await Kn("public",a.sender);await this.keyManager.setPeerPublicKey(d);const p=(await this.decryptResponseMessage(a)).result;if("error"in p)throw p.error;switch(e.method){case"eth_requestAccounts":{const c=p.value;this.accounts=c,this.storage.storeObject(jt,c),(r=this.callback)===null||r===void 0||r.call(this,"accountsChanged",c);break}}}async request(e){var n;if(this.accounts.length===0)switch(e.method){case"wallet_sendCalls":return this.sendRequestToPopup(e);default:throw L.provider.unauthorized()}switch(e.method){case"eth_requestAccounts":return(n=this.callback)===null||n===void 0||n.call(this,"connect",{chainId:re(this.chain.id)}),this.accounts;case"eth_accounts":return this.accounts;case"eth_coinbase":return this.accounts[0];case"net_version":return this.chain.id;case"eth_chainId":return re(this.chain.id);case"wallet_getCapabilities":return this.handleGetCapabilitiesRequest(e);case"wallet_switchEthereumChain":return this.handleSwitchChainRequest(e);case"eth_ecRecover":case"personal_sign":case"wallet_sign":case"personal_ecRecover":case"eth_signTransaction":case"eth_sendTransaction":case"eth_signTypedData_v1":case"eth_signTypedData_v3":case"eth_signTypedData_v4":case"eth_signTypedData":case"wallet_addEthereumChain":case"wallet_watchAsset":case"wallet_sendCalls":case"wallet_showCallsStatus":case"wallet_grantPermissions":return this.sendRequestToPopup(e);default:if(!this.chain.rpcUrl)throw L.rpc.internal("No RPC URL set for chain");return kt(e,this.chain.rpcUrl)}}async sendRequestToPopup(e){var n,s;await((s=(n=this.communicator).waitForPopupLoaded)===null||s===void 0?void 0:s.call(n));const i=await this.sendEncryptedRequest(e),o=(await this.decryptResponseMessage(i)).result;if("error"in o)throw o.error;return o.value}async cleanup(){var e,n;this.storage.clear(),await this.keyManager.clear(),this.accounts=[],this.chain={id:(n=(e=this.metadata.appChainIds)===null||e===void 0?void 0:e[0])!==null&&n!==void 0?n:1}}async handleSwitchChainRequest(e){var n;const s=e.params;if(!s||!(!((n=s[0])===null||n===void 0)&&n.chainId))throw L.rpc.invalidParams();const i=we(s[0].chainId);if(this.updateChain(i))return null;const o=await this.sendRequestToPopup(e);return o===null&&this.updateChain(i),o}async handleGetCapabilitiesRequest(e){Ti(e.params);const n=e.params[0],s=e.params[1];if(!this.accounts.some(a=>pi(a,n)))throw L.provider.unauthorized("no active account found");const i=this.storage.loadObject($t);if(!i)return{};if(!s||s.length===0)return i;const r=new Set(s.map(a=>Mt(a)));return Object.fromEntries(Object.entries(i).filter(([a])=>{try{const d=Mt(a);return r.has(d)}catch{return!1}}))}async sendEncryptedRequest(e){const n=await this.keyManager.getSharedSecret();if(!n)throw L.provider.unauthorized("No valid session found, try requestAccounts before other methods");const s=await Li({action:e,chainId:this.chain.id},n),i=await this.createRequestMessage({encrypted:s});return this.communicator.postRequestAndWaitForResponse(i)}async createRequestMessage(e){const n=await Fn("public",await this.keyManager.getOwnPublicKey());return{id:crypto.randomUUID(),sender:n,content:e,timestamp:new Date}}async decryptResponseMessage(e){var n,s;const i=e.content;if("failure"in i)throw i.failure;const r=await this.keyManager.getSharedSecret();if(!r)throw L.provider.unauthorized("Invalid session");const o=await Mi(i.encrypted,r),a=(n=o.data)===null||n===void 0?void 0:n.chains;if(a){const u=Object.entries(a).map(([p,c])=>({id:Number(p),rpcUrl:c}));this.storage.storeObject(qt,u),this.updateChain(this.chain.id,u)}const d=(s=o.data)===null||s===void 0?void 0:s.capabilities;return d&&this.storage.storeObject($t,d),o}updateChain(e,n){var s;const i=n??this.storage.loadObject(qt),r=i?.find(o=>o.id===e);return r?(r!==this.chain&&(this.chain=r,this.storage.storeObject(Wt,r),(s=this.callback)===null||s===void 0||s.call(this,"chainChanged",re(r.id))),!0):!1}}var R={},A={},zt;function Hi(){if(zt)return A;zt=1,Object.defineProperty(A,"__esModule",{value:!0}),A.toBig=A.shrSL=A.shrSH=A.rotrSL=A.rotrSH=A.rotrBL=A.rotrBH=A.rotr32L=A.rotr32H=A.rotlSL=A.rotlSH=A.rotlBL=A.rotlBH=A.add5L=A.add5H=A.add4L=A.add4H=A.add3L=A.add3H=void 0,A.add=v,A.fromBig=n,A.split=s;const t=BigInt(2**32-1),e=BigInt(32);function n(w,_=!1){return _?{h:Number(w&t),l:Number(w>>e&t)}:{h:Number(w>>e&t)|0,l:Number(w&t)|0}}function s(w,_=!1){const b=w.length;let T=new Uint32Array(b),W=new Uint32Array(b);for(let q=0;q<b;q++){const{h:ue,l:de}=n(w[q],_);[T[q],W[q]]=[ue,de]}return[T,W]}const i=(w,_)=>BigInt(w>>>0)<<e|BigInt(_>>>0);A.toBig=i;const r=(w,_,b)=>w>>>b;A.shrSH=r;const o=(w,_,b)=>w<<32-b|_>>>b;A.shrSL=o;const a=(w,_,b)=>w>>>b|_<<32-b;A.rotrSH=a;const d=(w,_,b)=>w<<32-b|_>>>b;A.rotrSL=d;const u=(w,_,b)=>w<<64-b|_>>>b-32;A.rotrBH=u;const p=(w,_,b)=>w>>>b-32|_<<64-b;A.rotrBL=p;const c=(w,_)=>_;A.rotr32H=c;const h=(w,_)=>w;A.rotr32L=h;const l=(w,_,b)=>w<<b|_>>>32-b;A.rotlSH=l;const f=(w,_,b)=>_<<b|w>>>32-b;A.rotlSL=f;const k=(w,_,b)=>_<<b-32|w>>>64-b;A.rotlBH=k;const m=(w,_,b)=>w<<b-32|_>>>64-b;A.rotlBL=m;function v(w,_,b,T){const W=(_>>>0)+(T>>>0);return{h:w+b+(W/2**32|0)|0,l:W|0}}const E=(w,_,b)=>(w>>>0)+(_>>>0)+(b>>>0);A.add3L=E;const I=(w,_,b,T)=>_+b+T+(w/2**32|0)|0;A.add3H=I;const x=(w,_,b,T)=>(w>>>0)+(_>>>0)+(b>>>0)+(T>>>0);A.add4L=x;const y=(w,_,b,T,W)=>_+b+T+W+(w/2**32|0)|0;A.add4H=y;const S=(w,_,b,T,W)=>(w>>>0)+(_>>>0)+(b>>>0)+(T>>>0)+(W>>>0);A.add5L=S;const M=(w,_,b,T,W,q)=>_+b+T+W+q+(w/2**32|0)|0;A.add5H=M;const P={fromBig:n,split:s,toBig:i,shrSH:r,shrSL:o,rotrSH:a,rotrSL:d,rotrBH:u,rotrBL:p,rotr32H:c,rotr32L:h,rotlSH:l,rotlSL:f,rotlBH:k,rotlBL:m,add:v,add3L:E,add3H:I,add4L:x,add4H:y,add5H:M,add5L:S};return A.default=P,A}var Je={},be={},Vt;function Bi(){return Vt||(Vt=1,Object.defineProperty(be,"__esModule",{value:!0}),be.crypto=void 0,be.crypto=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0),be}var Ft;function ji(){return Ft||(Ft=1,(function(t){/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */Object.defineProperty(t,"__esModule",{value:!0}),t.wrapXOFConstructorWithOpts=t.wrapConstructorWithOpts=t.wrapConstructor=t.Hash=t.nextTick=t.swap32IfBE=t.byteSwapIfBE=t.swap8IfBE=t.isLE=void 0,t.isBytes=n,t.anumber=s,t.abytes=i,t.ahash=r,t.aexists=o,t.aoutput=a,t.u8=d,t.u32=u,t.clean=p,t.createView=c,t.rotr=h,t.rotl=l,t.byteSwap=f,t.byteSwap32=k,t.bytesToHex=E,t.hexToBytes=y,t.asyncLoop=M,t.utf8ToBytes=P,t.bytesToUtf8=w,t.toBytes=_,t.kdfInputToBytes=b,t.concatBytes=T,t.checkOpts=W,t.createHasher=ue,t.createOptHasher=de,t.createXOFer=ae,t.randomBytes=ys;const e=Bi();function n(g){return g instanceof Uint8Array||ArrayBuffer.isView(g)&&g.constructor.name==="Uint8Array"}function s(g){if(!Number.isSafeInteger(g)||g<0)throw new Error("positive integer expected, got "+g)}function i(g,...C){if(!n(g))throw new Error("Uint8Array expected");if(C.length>0&&!C.includes(g.length))throw new Error("Uint8Array expected of length "+C+", got length="+g.length)}function r(g){if(typeof g!="function"||typeof g.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");s(g.outputLen),s(g.blockLen)}function o(g,C=!0){if(g.destroyed)throw new Error("Hash instance has been destroyed");if(C&&g.finished)throw new Error("Hash#digest() has already been called")}function a(g,C){i(g);const D=C.outputLen;if(g.length<D)throw new Error("digestInto() expects output buffer of length at least "+D)}function d(g){return new Uint8Array(g.buffer,g.byteOffset,g.byteLength)}function u(g){return new Uint32Array(g.buffer,g.byteOffset,Math.floor(g.byteLength/4))}function p(...g){for(let C=0;C<g.length;C++)g[C].fill(0)}function c(g){return new DataView(g.buffer,g.byteOffset,g.byteLength)}function h(g,C){return g<<32-C|g>>>C}function l(g,C){return g<<C|g>>>32-C>>>0}t.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function f(g){return g<<24&4278190080|g<<8&16711680|g>>>8&65280|g>>>24&255}t.swap8IfBE=t.isLE?g=>g:g=>f(g),t.byteSwapIfBE=t.swap8IfBE;function k(g){for(let C=0;C<g.length;C++)g[C]=f(g[C]);return g}t.swap32IfBE=t.isLE?g=>g:k;const m=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",v=Array.from({length:256},(g,C)=>C.toString(16).padStart(2,"0"));function E(g){if(i(g),m)return g.toHex();let C="";for(let D=0;D<g.length;D++)C+=v[g[D]];return C}const I={_0:48,_9:57,A:65,F:70,a:97,f:102};function x(g){if(g>=I._0&&g<=I._9)return g-I._0;if(g>=I.A&&g<=I.F)return g-(I.A-10);if(g>=I.a&&g<=I.f)return g-(I.a-10)}function y(g){if(typeof g!="string")throw new Error("hex string expected, got "+typeof g);if(m)return Uint8Array.fromHex(g);const C=g.length,D=C/2;if(C%2)throw new Error("hex string expected, got unpadded hex of length "+C);const U=new Uint8Array(D);for(let $=0,V=0;$<D;$++,V+=2){const St=x(g.charCodeAt(V)),At=x(g.charCodeAt(V+1));if(St===void 0||At===void 0){const ws=g[V]+g[V+1];throw new Error('hex string expected, got non-hex character "'+ws+'" at index '+V)}U[$]=St*16+At}return U}const S=async()=>{};t.nextTick=S;async function M(g,C,D){let U=Date.now();for(let $=0;$<g;$++){D($);const V=Date.now()-U;V>=0&&V<C||(await(0,t.nextTick)(),U+=V)}}function P(g){if(typeof g!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(g))}function w(g){return new TextDecoder().decode(g)}function _(g){return typeof g=="string"&&(g=P(g)),i(g),g}function b(g){return typeof g=="string"&&(g=P(g)),i(g),g}function T(...g){let C=0;for(let U=0;U<g.length;U++){const $=g[U];i($),C+=$.length}const D=new Uint8Array(C);for(let U=0,$=0;U<g.length;U++){const V=g[U];D.set(V,$),$+=V.length}return D}function W(g,C){if(C!==void 0&&{}.toString.call(C)!=="[object Object]")throw new Error("options should be object or undefined");return Object.assign(g,C)}class q{}t.Hash=q;function ue(g){const C=U=>g().update(_(U)).digest(),D=g();return C.outputLen=D.outputLen,C.blockLen=D.blockLen,C.create=()=>g(),C}function de(g){const C=(U,$)=>g($).update(_(U)).digest(),D=g({});return C.outputLen=D.outputLen,C.blockLen=D.blockLen,C.create=U=>g(U),C}function ae(g){const C=(U,$)=>g($).update(_(U)).digest(),D=g({});return C.outputLen=D.outputLen,C.blockLen=D.blockLen,C.create=U=>g(U),C}t.wrapConstructor=ue,t.wrapConstructorWithOpts=de,t.wrapXOFConstructorWithOpts=ae;function ys(g=32){if(e.crypto&&typeof e.crypto.getRandomValues=="function")return e.crypto.getRandomValues(new Uint8Array(g));if(e.crypto&&typeof e.crypto.randomBytes=="function")return Uint8Array.from(e.crypto.randomBytes(g));throw new Error("crypto.getRandomValues must be defined")}})(Je)),Je}var Kt;function Wi(){if(Kt)return R;Kt=1,Object.defineProperty(R,"__esModule",{value:!0}),R.shake256=R.shake128=R.keccak_512=R.keccak_384=R.keccak_256=R.keccak_224=R.sha3_512=R.sha3_384=R.sha3_256=R.sha3_224=R.Keccak=void 0,R.keccakP=m;const t=Hi(),e=ji(),n=BigInt(0),s=BigInt(1),i=BigInt(2),r=BigInt(7),o=BigInt(256),a=BigInt(113),d=[],u=[],p=[];for(let x=0,y=s,S=1,M=0;x<24;x++){[S,M]=[M,(2*S+3*M)%5],d.push(2*(5*M+S)),u.push((x+1)*(x+2)/2%64);let P=n;for(let w=0;w<7;w++)y=(y<<s^(y>>r)*a)%o,y&i&&(P^=s<<(s<<BigInt(w))-s);p.push(P)}const c=(0,t.split)(p,!0),h=c[0],l=c[1],f=(x,y,S)=>S>32?(0,t.rotlBH)(x,y,S):(0,t.rotlSH)(x,y,S),k=(x,y,S)=>S>32?(0,t.rotlBL)(x,y,S):(0,t.rotlSL)(x,y,S);function m(x,y=24){const S=new Uint32Array(10);for(let M=24-y;M<24;M++){for(let _=0;_<10;_++)S[_]=x[_]^x[_+10]^x[_+20]^x[_+30]^x[_+40];for(let _=0;_<10;_+=2){const b=(_+8)%10,T=(_+2)%10,W=S[T],q=S[T+1],ue=f(W,q,1)^S[b],de=k(W,q,1)^S[b+1];for(let ae=0;ae<50;ae+=10)x[_+ae]^=ue,x[_+ae+1]^=de}let P=x[2],w=x[3];for(let _=0;_<24;_++){const b=u[_],T=f(P,w,b),W=k(P,w,b),q=d[_];P=x[q],w=x[q+1],x[q]=T,x[q+1]=W}for(let _=0;_<50;_+=10){for(let b=0;b<10;b++)S[b]=x[_+b];for(let b=0;b<10;b++)x[_+b]^=~S[(b+2)%10]&S[(b+4)%10]}x[0]^=h[M],x[1]^=l[M]}(0,e.clean)(S)}class v extends e.Hash{constructor(y,S,M,P=!1,w=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=y,this.suffix=S,this.outputLen=M,this.enableXOF=P,this.rounds=w,(0,e.anumber)(M),!(0<y&&y<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=(0,e.u32)(this.state)}clone(){return this._cloneInto()}keccak(){(0,e.swap32IfBE)(this.state32),m(this.state32,this.rounds),(0,e.swap32IfBE)(this.state32),this.posOut=0,this.pos=0}update(y){(0,e.aexists)(this),y=(0,e.toBytes)(y),(0,e.abytes)(y);const{blockLen:S,state:M}=this,P=y.length;for(let w=0;w<P;){const _=Math.min(S-this.pos,P-w);for(let b=0;b<_;b++)M[this.pos++]^=y[w++];this.pos===S&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:y,suffix:S,pos:M,blockLen:P}=this;y[M]^=S,(S&128)!==0&&M===P-1&&this.keccak(),y[P-1]^=128,this.keccak()}writeInto(y){(0,e.aexists)(this,!1),(0,e.abytes)(y),this.finish();const S=this.state,{blockLen:M}=this;for(let P=0,w=y.length;P<w;){this.posOut>=M&&this.keccak();const _=Math.min(M-this.posOut,w-P);y.set(S.subarray(this.posOut,this.posOut+_),P),this.posOut+=_,P+=_}return y}xofInto(y){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(y)}xof(y){return(0,e.anumber)(y),this.xofInto(new Uint8Array(y))}digestInto(y){if((0,e.aoutput)(y,this),this.finished)throw new Error("digest() was already called");return this.writeInto(y),this.destroy(),y}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,(0,e.clean)(this.state)}_cloneInto(y){const{blockLen:S,suffix:M,outputLen:P,rounds:w,enableXOF:_}=this;return y||(y=new v(S,M,P,_,w)),y.state32.set(this.state32),y.pos=this.pos,y.posOut=this.posOut,y.finished=this.finished,y.rounds=w,y.suffix=M,y.outputLen=P,y.enableXOF=_,y.destroyed=this.destroyed,y}}R.Keccak=v;const E=(x,y,S)=>(0,e.createHasher)(()=>new v(y,x,S));R.sha3_224=E(6,144,224/8),R.sha3_256=E(6,136,256/8),R.sha3_384=E(6,104,384/8),R.sha3_512=E(6,72,512/8),R.keccak_224=E(1,144,224/8),R.keccak_256=E(1,136,256/8),R.keccak_384=E(1,104,384/8),R.keccak_512=E(1,72,512/8);const I=(x,y,S)=>(0,e.createXOFer)((M={})=>new v(y,x,M.dkLen===void 0?S:M.dkLen,!0));return R.shake128=I(31,168,128/8),R.shake256=I(31,136,256/8),R}var Qe,Zt;function Gn(){if(Zt)return Qe;Zt=1;const{keccak_256:t}=Wi();function e(l){return Buffer.allocUnsafe(l).fill(0)}function n(l){return l.toString(2).length}function s(l,f){let k=l.toString(16);k.length%2!==0&&(k="0"+k);const m=k.match(/.{1,2}/g).map(v=>parseInt(v,16));for(;m.length<f;)m.unshift(0);return Buffer.from(m)}function i(l,f){const k=l<0n;let m;if(k){const v=(1n<<BigInt(f))-1n;m=(~l&v)+1n}else m=l;return m&=(1n<<BigInt(f))-1n,m}function r(l,f,k){const m=e(f);return l=a(l),k?l.length<f?(l.copy(m),m):l.slice(0,f):l.length<f?(l.copy(m,f-l.length),m):l.slice(-f)}function o(l,f){return r(l,f,!0)}function a(l){if(!Buffer.isBuffer(l))if(Array.isArray(l))l=Buffer.from(l);else if(typeof l=="string")c(l)?l=Buffer.from(p(h(l)),"hex"):l=Buffer.from(l);else if(typeof l=="number")l=intToBuffer(l);else if(l==null)l=Buffer.allocUnsafe(0);else if(typeof l=="bigint")l=s(l);else if(l.toArray)l=Buffer.from(l.toArray());else throw new Error("invalid type");return l}function d(l){return l=a(l),"0x"+l.toString("hex")}function u(l,f){if(l=a(l),f||(f=256),f!==256)throw new Error("unsupported");return Buffer.from(t(new Uint8Array(l)))}function p(l){return l.length%2?"0"+l:l}function c(l){return typeof l=="string"&&l.match(/^0x[0-9A-Fa-f]*$/)}function h(l){return typeof l=="string"&&l.startsWith("0x")?l.slice(2):l}return Qe={zeros:e,setLength:r,setLengthRight:o,isHexString:c,stripHexPrefix:h,toBuffer:a,bufferToHex:d,keccak:u,bitLengthFromBigInt:n,bufferBEFromBigInt:s,twosFromBigInt:i},Qe}var Xe,Gt;function qi(){if(Gt)return Xe;Gt=1;const t=Gn();function e(h){return h.startsWith("int[")?"int256"+h.slice(3):h==="int"?"int256":h.startsWith("uint[")?"uint256"+h.slice(4):h==="uint"?"uint256":h.startsWith("fixed[")?"fixed128x128"+h.slice(5):h==="fixed"?"fixed128x128":h.startsWith("ufixed[")?"ufixed128x128"+h.slice(6):h==="ufixed"?"ufixed128x128":h}function n(h){return Number.parseInt(/^\D+(\d+)$/.exec(h)[1],10)}function s(h){var l=/^\D+(\d+)x(\d+)$/.exec(h);return[Number.parseInt(l[1],10),Number.parseInt(l[2],10)]}function i(h){var l=h.match(/(.*)\[(.*?)\]$/);return l?l[2]===""?"dynamic":Number.parseInt(l[2],10):null}function r(h){var l=typeof h;if(l==="string"||l==="number")return BigInt(h);if(l==="bigint")return h;throw new Error("Argument is not a number")}function o(h,l){var f,k,m,v;if(h==="address")return o("uint160",r(l));if(h==="bool")return o("uint8",l?1:0);if(h==="string")return o("bytes",new Buffer(l,"utf8"));if(d(h)){if(typeof l.length>"u")throw new Error("Not an array?");if(f=i(h),f!=="dynamic"&&f!==0&&l.length>f)throw new Error("Elements exceed array size: "+f);m=[],h=h.slice(0,h.lastIndexOf("[")),typeof l=="string"&&(l=JSON.parse(l));for(v in l)m.push(o(h,l[v]));if(f==="dynamic"){var E=o("uint256",l.length);m.unshift(E)}return Buffer.concat(m)}else{if(h==="bytes")return l=new Buffer(l),m=Buffer.concat([o("uint256",l.length),l]),l.length%32!==0&&(m=Buffer.concat([m,t.zeros(32-l.length%32)])),m;if(h.startsWith("bytes")){if(f=n(h),f<1||f>32)throw new Error("Invalid bytes<N> width: "+f);return t.setLengthRight(l,32)}else if(h.startsWith("uint")){if(f=n(h),f%8||f<8||f>256)throw new Error("Invalid uint<N> width: "+f);k=r(l);const I=t.bitLengthFromBigInt(k);if(I>f)throw new Error("Supplied uint exceeds width: "+f+" vs "+I);if(k<0)throw new Error("Supplied uint is negative");return t.bufferBEFromBigInt(k,32)}else if(h.startsWith("int")){if(f=n(h),f%8||f<8||f>256)throw new Error("Invalid int<N> width: "+f);k=r(l);const I=t.bitLengthFromBigInt(k);if(I>f)throw new Error("Supplied int exceeds width: "+f+" vs "+I);const x=t.twosFromBigInt(k,256);return t.bufferBEFromBigInt(x,32)}else if(h.startsWith("ufixed")){if(f=s(h),k=r(l),k<0)throw new Error("Supplied ufixed is negative");return o("uint256",k*BigInt(2)**BigInt(f[1]))}else if(h.startsWith("fixed"))return f=s(h),o("int256",r(l)*BigInt(2)**BigInt(f[1]))}throw new Error("Unsupported or invalid type: "+h)}function a(h){return h==="string"||h==="bytes"||i(h)==="dynamic"}function d(h){return h.lastIndexOf("]")===h.length-1}function u(h,l){var f=[],k=[],m=32*h.length;for(var v in h){var E=e(h[v]),I=l[v],x=o(E,I);a(E)?(f.push(o("uint256",m)),k.push(x),m+=x.length):f.push(x)}return Buffer.concat(f.concat(k))}function p(h,l){if(h.length!==l.length)throw new Error("Number of types are not matching the values");for(var f,k,m=[],v=0;v<h.length;v++){var E=e(h[v]),I=l[v];if(E==="bytes")m.push(I);else if(E==="string")m.push(new Buffer(I,"utf8"));else if(E==="bool")m.push(new Buffer(I?"01":"00","hex"));else if(E==="address")m.push(t.setLength(I,20));else if(E.startsWith("bytes")){if(f=n(E),f<1||f>32)throw new Error("Invalid bytes<N> width: "+f);m.push(t.setLengthRight(I,f))}else if(E.startsWith("uint")){if(f=n(E),f%8||f<8||f>256)throw new Error("Invalid uint<N> width: "+f);k=r(I);const x=t.bitLengthFromBigInt(k);if(x>f)throw new Error("Supplied uint exceeds width: "+f+" vs "+x);m.push(t.bufferBEFromBigInt(k,f/8))}else if(E.startsWith("int")){if(f=n(E),f%8||f<8||f>256)throw new Error("Invalid int<N> width: "+f);k=r(I);const x=t.bitLengthFromBigInt(k);if(x>f)throw new Error("Supplied int exceeds width: "+f+" vs "+x);const y=t.twosFromBigInt(k,f);m.push(t.bufferBEFromBigInt(y,f/8))}else throw new Error("Unsupported or invalid type: "+E)}return Buffer.concat(m)}function c(h,l){return t.keccak(p(h,l))}return Xe={rawEncode:u,solidityPack:p,soliditySHA3:c},Xe}var et,Yt;function $i(){if(Yt)return et;Yt=1;const t=Gn(),e=qi(),n={type:"object",properties:{types:{type:"object",additionalProperties:{type:"array",items:{type:"object",properties:{name:{type:"string"},type:{type:"string"}},required:["name","type"]}}},primaryType:{type:"string"},domain:{type:"object"},message:{type:"object"}},required:["types","primaryType","domain","message"]},s={encodeData(r,o,a,d=!0){const u=["bytes32"],p=[this.hashType(r,a)];if(d){const c=(h,l,f)=>{if(a[l]!==void 0)return["bytes32",f==null?"0x0000000000000000000000000000000000000000000000000000000000000000":t.keccak(this.encodeData(l,f,a,d))];if(f===void 0)throw new Error(`missing value for field ${h} of type ${l}`);if(l==="bytes")return["bytes32",t.keccak(f)];if(l==="string")return typeof f=="string"&&(f=Buffer.from(f,"utf8")),["bytes32",t.keccak(f)];if(l.lastIndexOf("]")===l.length-1){const k=l.slice(0,l.lastIndexOf("[")),m=f.map(v=>c(h,k,v));return["bytes32",t.keccak(e.rawEncode(m.map(([v])=>v),m.map(([,v])=>v)))]}return[l,f]};for(const h of a[r]){const[l,f]=c(h.name,h.type,o[h.name]);u.push(l),p.push(f)}}else for(const c of a[r]){let h=o[c.name];if(h!==void 0)if(c.type==="bytes")u.push("bytes32"),h=t.keccak(h),p.push(h);else if(c.type==="string")u.push("bytes32"),typeof h=="string"&&(h=Buffer.from(h,"utf8")),h=t.keccak(h),p.push(h);else if(a[c.type]!==void 0)u.push("bytes32"),h=t.keccak(this.encodeData(c.type,h,a,d)),p.push(h);else{if(c.type.lastIndexOf("]")===c.type.length-1)throw new Error("Arrays currently unimplemented in encodeData");u.push(c.type),p.push(h)}}return e.rawEncode(u,p)},encodeType(r,o){let a="",d=this.findTypeDependencies(r,o).filter(u=>u!==r);d=[r].concat(d.sort());for(const u of d){if(!o[u])throw new Error("No type definition specified: "+u);a+=u+"("+o[u].map(({name:c,type:h})=>h+" "+c).join(",")+")"}return a},findTypeDependencies(r,o,a=[]){if(r=r.match(/^\w*/)[0],a.includes(r)||o[r]===void 0)return a;a.push(r);for(const d of o[r])for(const u of this.findTypeDependencies(d.type,o,a))!a.includes(u)&&a.push(u);return a},hashStruct(r,o,a,d=!0){return t.keccak(this.encodeData(r,o,a,d))},hashType(r,o){return t.keccak(this.encodeType(r,o))},sanitizeData(r){const o={};for(const a in n.properties)r[a]&&(o[a]=r[a]);return o.types&&(o.types=Object.assign({EIP712Domain:[]},o.types)),o},hash(r,o=!0){const a=this.sanitizeData(r),d=[Buffer.from("1901","hex")];return d.push(this.hashStruct("EIP712Domain",a.domain,a.types,o)),a.primaryType!=="EIP712Domain"&&d.push(this.hashStruct(a.primaryType,a.message,a.types,o)),t.keccak(Buffer.concat(d))}};et={TYPED_MESSAGE_SCHEMA:n,TypedDataUtils:s,hashForSignTypedDataLegacy:function(r){return i(r.data)},hashForSignTypedData_v3:function(r){return s.hash(r.data,!1)},hashForSignTypedData_v4:function(r){return s.hash(r.data)}};function i(r){const o=new Error("Expect argument to be non-empty array");if(typeof r!="object"||!r.length)throw o;const a=r.map(function(p){return p.type==="bytes"?t.toBuffer(p.value):p.value}),d=r.map(function(p){return p.type}),u=r.map(function(p){if(!p.name)throw o;return p.type+" "+p.name});return e.soliditySHA3(["bytes32","bytes32"],[e.soliditySHA3(new Array(r.length).fill("string"),u),e.soliditySHA3(d,a)])}return et}var zi=$i();const Se=kn(zi),Vi="walletUsername",at="Addresses",Fi="AppVersion";function z(t){return t.errorMessage!==void 0}class Ki{constructor(e){this.secret=e}async encrypt(e){const n=this.secret;if(n.length!==64)throw Error("secret must be 256 bits");const s=crypto.getRandomValues(new Uint8Array(12)),i=await crypto.subtle.importKey("raw",Me(n),{name:"aes-gcm"},!1,["encrypt","decrypt"]),r=new TextEncoder,o=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:s},i,r.encode(e)),a=16,d=o.slice(o.byteLength-a),u=o.slice(0,o.byteLength-a),p=new Uint8Array(d),c=new Uint8Array(u),h=new Uint8Array([...s,...p,...c]);return yt(h)}async decrypt(e){const n=this.secret;if(n.length!==64)throw Error("secret must be 256 bits");return new Promise((s,i)=>{(async function(){const r=await crypto.subtle.importKey("raw",Me(n),{name:"aes-gcm"},!1,["encrypt","decrypt"]),o=Me(e),a=o.slice(0,12),d=o.slice(12,28),u=o.slice(28),p=new Uint8Array([...u,...d]),c={name:"AES-GCM",iv:new Uint8Array(a)};try{const h=await window.crypto.subtle.decrypt(c,r,p),l=new TextDecoder;s(l.decode(h))}catch(h){i(h)}})()})}}class Zi{constructor(e,n,s){this.linkAPIUrl=e,this.sessionId=n;const i=`${n}:${s}`;this.auth=`Basic ${btoa(i)}`}async markUnseenEventsAsSeen(e){return Promise.all(e.map(n=>fetch(`${this.linkAPIUrl}/events/${n.eventId}/seen`,{method:"POST",headers:{Authorization:this.auth}}))).catch(n=>console.error("Unabled to mark event as failed:",n))}async fetchUnseenEvents(){var e;const n=await fetch(`${this.linkAPIUrl}/events?unseen=true`,{headers:{Authorization:this.auth}});if(n.ok){const{events:s,error:i}=await n.json();if(i)throw new Error(`Check unseen events failed: ${i}`);const r=(e=s?.filter(o=>o.event==="Web3Response").map(o=>({type:"Event",sessionId:this.sessionId,eventId:o.id,event:o.event,data:o.data})))!==null&&e!==void 0?e:[];return this.markUnseenEventsAsSeen(r),r}throw new Error(`Check unseen events failed: ${n.status}`)}}var Y;(function(t){t[t.DISCONNECTED=0]="DISCONNECTED",t[t.CONNECTING=1]="CONNECTING",t[t.CONNECTED=2]="CONNECTED"})(Y||(Y={}));class F{setConnectionStateListener(e){this.connectionStateListener=e}setIncomingDataListener(e){this.incomingDataListener=e}constructor(e,n=WebSocket){this.WebSocketClass=n,this.webSocket=null,this.isDisconnecting=!1,this.url=e.replace(/^http/,"ws"),this.instanceId=F.instanceCounter++,F.activeInstances.add(this.instanceId)}async connect(){if(this.webSocket)throw new Error("webSocket object is not null");if(this.isDisconnecting)throw new Error("WebSocket is disconnecting, cannot reconnect on same instance");return new Promise((e,n)=>{var s;let i;try{this.webSocket=i=new this.WebSocketClass(this.url)}catch(r){n(r);return}(s=this.connectionStateListener)===null||s===void 0||s.call(this,Y.CONNECTING),i.onclose=r=>{var o;this.clearWebSocket(),i.readyState!==WebSocket.OPEN&&n(new Error(`websocket error ${r.code}: ${r.reason}`)),(o=this.connectionStateListener)===null||o===void 0||o.call(this,Y.DISCONNECTED)},i.onopen=r=>{var o;e(),(o=this.connectionStateListener)===null||o===void 0||o.call(this,Y.CONNECTED),F.pendingData.length>0&&([...F.pendingData].forEach(d=>this.sendData(d)),F.pendingData=[])},i.onmessage=r=>{var o,a;if(r.data==="h")(o=this.incomingDataListener)===null||o===void 0||o.call(this,{type:"Heartbeat"});else try{const d=JSON.parse(r.data);(a=this.incomingDataListener)===null||a===void 0||a.call(this,d)}catch{}}})}disconnect(){var e;const{webSocket:n}=this;if(n){this.isDisconnecting=!0,this.clearWebSocket(),(e=this.connectionStateListener)===null||e===void 0||e.call(this,Y.DISCONNECTED),this.connectionStateListener=void 0,this.incomingDataListener=void 0;try{n.close()}catch{}}}sendData(e){const{webSocket:n}=this;if(!n){F.pendingData.push(e),this.isDisconnecting||this.connect();return}if(n.readyState!==WebSocket.OPEN){F.pendingData.push(e);return}n.send(e)}clearWebSocket(){const{webSocket:e}=this;e&&(this.webSocket=null,e.onclose=null,e.onerror=null,e.onmessage=null,e.onopen=null)}cleanup(){F.activeInstances.delete(this.instanceId)}}F.instanceCounter=0;F.activeInstances=new Set;F.pendingData=[];const Jt=1e4,Gi=6e4;class Yi{constructor({session:e,linkAPIUrl:n,listener:s}){this.destroyed=!1,this.lastHeartbeatResponse=0,this.nextReqId=X(1),this.reconnectAttempts=0,this.isReconnecting=!1,this._connected=!1,this._linked=!1,this.requestResolutions=new Map,this.handleSessionMetadataUpdated=r=>{if(!r)return;new Map([["__destroyed",this.handleDestroyed],["EthereumAddress",this.handleAccountUpdated],["WalletUsername",this.handleWalletUsernameUpdated],["AppVersion",this.handleAppVersionUpdated],["ChainId",a=>r.JsonRpcUrl&&this.handleChainUpdated(a,r.JsonRpcUrl)]]).forEach((a,d)=>{const u=r[d];u!==void 0&&a(u)})},this.handleDestroyed=r=>{var o;r==="1"&&((o=this.listener)===null||o===void 0||o.resetAndReload())},this.handleAccountUpdated=async r=>{var o;try{const a=await this.cipher.decrypt(r);(o=this.listener)===null||o===void 0||o.accountUpdated(a)}catch{}},this.handleMetadataUpdated=async(r,o)=>{var a;try{const d=await this.cipher.decrypt(o);(a=this.listener)===null||a===void 0||a.metadataUpdated(r,d)}catch{}},this.handleWalletUsernameUpdated=async r=>{this.handleMetadataUpdated(Vi,r)},this.handleAppVersionUpdated=async r=>{this.handleMetadataUpdated(Fi,r)},this.handleChainUpdated=async(r,o)=>{var a;try{const d=await this.cipher.decrypt(r),u=await this.cipher.decrypt(o);(a=this.listener)===null||a===void 0||a.chainUpdated(d,u)}catch{}},this.session=e,this.cipher=new Ki(e.secret),this.listener=s,this.linkAPIUrl=n,this.WebSocketClass=WebSocket;const i=this.createWebSocket();this.ws=i,this.http=new Zi(n,e.id,e.key),this.setupVisibilityChangeHandler()}createWebSocket(){const e=new F(`${this.linkAPIUrl}/rpc`,this.WebSocketClass);return this.activeWsInstance=e,e.setConnectionStateListener(async n=>{if(e!==this.activeWsInstance)return;let s=!1;switch(n){case Y.DISCONNECTED:this.heartbeatIntervalId&&(clearInterval(this.heartbeatIntervalId),this.heartbeatIntervalId=void 0),this.lastHeartbeatResponse=0,s=!1,this.destroyed||(async()=>{if(this.isReconnecting)return;this.isReconnecting=!0;const r=this.reconnectAttempts===0?0:3e3;await new Promise(o=>setTimeout(o,r)),!this.destroyed&&e===this.activeWsInstance?(this.reconnectAttempts++,"cleanup"in this.ws&&typeof this.ws.cleanup=="function"&&this.ws.cleanup(),this.ws=this.createWebSocket(),this.ws.connect().catch(()=>{}).finally(()=>{this.isReconnecting=!1})):this.isReconnecting=!1})();break;case Y.CONNECTED:this.reconnectAttempts=0;try{s=await this.handleConnected(),this.fetchUnseenEventsAPI().catch(()=>{})}catch{break}this.connected=s,this.updateLastHeartbeat(),this.heartbeatIntervalId&&clearInterval(this.heartbeatIntervalId),this.heartbeatIntervalId=window.setInterval(()=>{this.heartbeat()},Jt),setTimeout(()=>{this.heartbeat()},100);break;case Y.CONNECTING:break}n!==Y.CONNECTED&&(this.connected=s)}),e.setIncomingDataListener(n=>{var s;switch(n.type){case"Heartbeat":this.updateLastHeartbeat();return;case"IsLinkedOK":case"Linked":{const i=n.type==="IsLinkedOK"?n.linked:void 0;this.linked=i||n.onlineGuests>0;break}case"GetSessionConfigOK":case"SessionConfigUpdated":{this.handleSessionMetadataUpdated(n.metadata);break}case"Event":{this.handleIncomingEvent(n);break}}n.id!==void 0&&((s=this.requestResolutions.get(n.id))===null||s===void 0||s(n))}),e}setupVisibilityChangeHandler(){this.visibilityChangeHandler=()=>{!document.hidden&&!this.destroyed&&(this.connected?this.heartbeat():this.reconnectWithFreshWebSocket())},this.focusHandler=()=>{!this.destroyed&&!this.connected&&this.reconnectWithFreshWebSocket()},document.addEventListener("visibilitychange",this.visibilityChangeHandler),window.addEventListener("focus",this.focusHandler),window.addEventListener("pageshow",e=>{e.persisted&&this.focusHandler&&this.focusHandler()})}reconnectWithFreshWebSocket(){if(this.destroyed)return;const e=this.ws;this.activeWsInstance=void 0,e.disconnect(),"cleanup"in e&&typeof e.cleanup=="function"&&e.cleanup(),this.ws=this.createWebSocket(),this.ws.connect().catch(()=>{})}connect(){if(this.destroyed)throw new Error("instance is destroyed");this.ws.connect()}async destroy(){this.destroyed||(await this.makeRequest({type:"SetSessionConfig",id:X(this.nextReqId++),sessionId:this.session.id,metadata:{__destroyed:"1"}},{timeout:1e3}),this.destroyed=!0,this.activeWsInstance=void 0,this.heartbeatIntervalId&&(clearInterval(this.heartbeatIntervalId),this.heartbeatIntervalId=void 0),this.visibilityChangeHandler&&document.removeEventListener("visibilitychange",this.visibilityChangeHandler),this.focusHandler&&window.removeEventListener("focus",this.focusHandler),this.ws.disconnect(),"cleanup"in this.ws&&typeof this.ws.cleanup=="function"&&this.ws.cleanup(),this.listener=void 0)}get connected(){return this._connected}set connected(e){this._connected=e}get linked(){return this._linked}set linked(e){var n,s;this._linked=e,e&&((n=this.onceLinked)===null||n===void 0||n.call(this)),(s=this.listener)===null||s===void 0||s.linkedUpdated(e)}setOnceLinked(e){return new Promise(n=>{this.linked?e().then(n):this.onceLinked=()=>{e().then(n),this.onceLinked=void 0}})}async handleIncomingEvent(e){var n;if(!(e.type!=="Event"||e.event!=="Web3Response"))try{const s=await this.cipher.decrypt(e.data),i=JSON.parse(s);if(i.type!=="WEB3_RESPONSE")return;(n=this.listener)===null||n===void 0||n.handleWeb3ResponseMessage(i.id,i.response)}catch{}}async checkUnseenEvents(){await new Promise(e=>setTimeout(e,250));try{await this.fetchUnseenEventsAPI()}catch(e){console.error("Unable to check for unseen events",e)}}async fetchUnseenEventsAPI(){try{(await this.http.fetchUnseenEvents()).forEach(n=>{this.handleIncomingEvent(n)})}catch{}}async publishEvent(e,n,s=!1){const i=await this.cipher.encrypt(JSON.stringify(Object.assign(Object.assign({},n),{origin:location.origin,location:location.href,relaySource:"coinbaseWalletExtension"in window&&window.coinbaseWalletExtension?"injected_sdk":"sdk"}))),r={type:"PublishEvent",id:X(this.nextReqId++),sessionId:this.session.id,event:e,data:i,callWebhook:s};return this.setOnceLinked(async()=>{const o=await this.makeRequest(r);if(o.type==="Fail")throw new Error(o.error||"failed to publish event");return o.eventId})}sendData(e){this.ws.sendData(JSON.stringify(e))}updateLastHeartbeat(){this.lastHeartbeatResponse=Date.now()}heartbeat(){if(Date.now()-this.lastHeartbeatResponse>Jt*2){this.ws.disconnect();return}if(this.connected)try{this.ws.sendData("h")}catch{}}async makeRequest(e,n={timeout:Gi}){const s=e.id;this.sendData(e);let i;return Promise.race([new Promise((r,o)=>{i=window.setTimeout(()=>{o(new Error(`request ${s} timed out`))},n.timeout)}),new Promise(r=>{this.requestResolutions.set(s,o=>{clearTimeout(i),r(o),this.requestResolutions.delete(s)})})])}async handleConnected(){return(await this.makeRequest({type:"HostSession",id:X(this.nextReqId++),sessionId:this.session.id,sessionKey:this.session.key})).type==="Fail"?!1:(this.sendData({type:"IsLinked",id:X(this.nextReqId++),sessionId:this.session.id}),this.sendData({type:"GetSessionConfig",id:X(this.nextReqId++),sessionId:this.session.id}),!0)}}class Ji{constructor(){this._nextRequestId=0,this.callbacks=new Map}makeRequestId(){this._nextRequestId=(this._nextRequestId+1)%2147483647;const e=this._nextRequestId,n=zn(e.toString(16));return this.callbacks.get(n)&&this.callbacks.delete(n),e}}const Qt="session:id",Xt="session:secret",en="session:linked";class fe{constructor(e,n,s,i=!1){this.storage=e,this.id=n,this.secret=s,this.key=Vs(fi(`${n}, ${s} WalletLink`)),this._linked=!!i}static create(e){const n=ce(16),s=ce(32);return new fe(e,n,s).save()}static load(e){const n=e.getItem(Qt),s=e.getItem(en),i=e.getItem(Xt);return n&&i?new fe(e,n,i,s==="1"):null}get linked(){return this._linked}set linked(e){this._linked=e,this.persistLinked()}save(){return this.storage.setItem(Qt,this.id),this.storage.setItem(Xt,this.secret),this.persistLinked(),this}persistLinked(){this.storage.setItem(en,this._linked?"1":"0")}}function Qi(){try{return window.frameElement!==null}catch{return!1}}function Xi(){try{return Qi()&&window.top?window.top.location:window.location}catch{return window.location}}function er(){var t;return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test((t=window?.navigator)===null||t===void 0?void 0:t.userAgent)}function Yn(){var t,e;return(e=(t=window?.matchMedia)===null||t===void 0?void 0:t.call(window,"(prefers-color-scheme: dark)").matches)!==null&&e!==void 0?e:!1}const tr='@namespace svg "http://www.w3.org/2000/svg";.-cbwsdk-css-reset,.-cbwsdk-css-reset *{animation:none;animation-delay:0;animation-direction:normal;animation-duration:0;animation-fill-mode:none;animation-iteration-count:1;animation-name:none;animation-play-state:running;animation-timing-function:ease;backface-visibility:visible;background:0;background-attachment:scroll;background-clip:border-box;background-color:rgba(0,0,0,0);background-image:none;background-origin:padding-box;background-position:0 0;background-position-x:0;background-position-y:0;background-repeat:repeat;background-size:auto auto;border:0;border-style:none;border-width:medium;border-color:inherit;border-bottom:0;border-bottom-color:inherit;border-bottom-left-radius:0;border-bottom-right-radius:0;border-bottom-style:none;border-bottom-width:medium;border-collapse:separate;border-image:none;border-left:0;border-left-color:inherit;border-left-style:none;border-left-width:medium;border-radius:0;border-right:0;border-right-color:inherit;border-right-style:none;border-right-width:medium;border-spacing:0;border-top:0;border-top-color:inherit;border-top-left-radius:0;border-top-right-radius:0;border-top-style:none;border-top-width:medium;box-shadow:none;box-sizing:border-box;caption-side:top;clear:none;clip:auto;color:inherit;columns:auto;column-count:auto;column-fill:balance;column-gap:normal;column-rule:medium none currentColor;column-rule-color:currentColor;column-rule-style:none;column-rule-width:none;column-span:1;column-width:auto;counter-increment:none;counter-reset:none;direction:ltr;empty-cells:show;float:none;font:normal;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Helvetica Neue",Arial,sans-serif;font-size:medium;font-style:normal;font-variant:normal;font-weight:normal;height:auto;hyphens:none;letter-spacing:normal;line-height:normal;list-style:none;list-style-image:none;list-style-position:outside;list-style-type:disc;margin:0;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;opacity:1;orphans:0;outline:0;outline-color:invert;outline-style:none;outline-width:medium;overflow:visible;overflow-x:visible;overflow-y:visible;padding:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;page-break-after:auto;page-break-before:auto;page-break-inside:auto;perspective:none;perspective-origin:50% 50%;pointer-events:auto;position:static;quotes:"\\201C" "\\201D" "\\2018" "\\2019";tab-size:8;table-layout:auto;text-align:inherit;text-align-last:auto;text-decoration:none;text-decoration-color:inherit;text-decoration-line:none;text-decoration-style:solid;text-indent:0;text-shadow:none;text-transform:none;transform:none;transform-style:flat;transition:none;transition-delay:0s;transition-duration:0s;transition-property:none;transition-timing-function:ease;unicode-bidi:normal;vertical-align:baseline;visibility:visible;white-space:normal;widows:0;word-spacing:normal;z-index:auto}.-cbwsdk-css-reset strong{font-weight:bold}.-cbwsdk-css-reset *{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Helvetica Neue",Arial,sans-serif;line-height:1}.-cbwsdk-css-reset [class*=container]{margin:0;padding:0}.-cbwsdk-css-reset style{display:none}';function Jn(){const t=document.createElement("style");t.type="text/css",t.appendChild(document.createTextNode(tr)),document.documentElement.appendChild(t)}function Qn(t){var e,n,s="";if(typeof t=="string"||typeof t=="number")s+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=Qn(t[e]))&&(s&&(s+=" "),s+=n);else for(e in t)t[e]&&(s&&(s+=" "),s+=e);return s}function ve(){for(var t,e,n=0,s="";n<arguments.length;)(t=arguments[n++])&&(e=Qn(t))&&(s&&(s+=" "),s+=e);return s}var je,N,Xn,le,tn,es,ts,ns,Et,ct,lt,Ie={},ss=[],nr=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,We=Array.isArray;function te(t,e){for(var n in e)t[n]=e[n];return t}function It(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function O(t,e,n){var s,i,r,o={};for(r in e)r=="key"?s=e[r]:r=="ref"?i=e[r]:o[r]=e[r];if(arguments.length>2&&(o.children=arguments.length>3?je.call(arguments,2):n),typeof t=="function"&&t.defaultProps!=null)for(r in t.defaultProps)o[r]===void 0&&(o[r]=t.defaultProps[r]);return Pe(t,o,s,i,null)}function Pe(t,e,n,s,i){var r={type:t,props:e,key:n,ref:s,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:i??++Xn,__i:-1,__u:0};return i==null&&N.vnode!=null&&N.vnode(r),r}function qe(t){return t.children}function Te(t,e){this.props=t,this.context=e}function ge(t,e){if(e==null)return t.__?ge(t.__,t.__i+1):null;for(var n;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null)return n.__e;return typeof t.type=="function"?ge(t):null}function is(t){var e,n;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null){t.__e=t.__c.base=n.__e;break}return is(t)}}function nn(t){(!t.__d&&(t.__d=!0)&&le.push(t)&&!Ne.__r++||tn!=N.debounceRendering)&&((tn=N.debounceRendering)||es)(Ne)}function Ne(){for(var t,e,n,s,i,r,o,a=1;le.length;)le.length>a&&le.sort(ts),t=le.shift(),a=le.length,t.__d&&(n=void 0,i=(s=(e=t).__v).__e,r=[],o=[],e.__P&&((n=te({},s)).__v=s.__v+1,N.vnode&&N.vnode(n),xt(e.__P,n,s,e.__n,e.__P.namespaceURI,32&s.__u?[i]:null,r,i??ge(s),!!(32&s.__u),o),n.__v=s.__v,n.__.__k[n.__i]=n,as(r,n,o),n.__e!=i&&is(n)));Ne.__r=0}function rs(t,e,n,s,i,r,o,a,d,u,p){var c,h,l,f,k,m,v,E=s&&s.__k||ss,I=e.length;for(d=sr(n,e,E,d,I),c=0;c<I;c++)(l=n.__k[c])!=null&&(h=l.__i==-1?Ie:E[l.__i]||Ie,l.__i=c,m=xt(t,l,h,i,r,o,a,d,u,p),f=l.__e,l.ref&&h.ref!=l.ref&&(h.ref&&Ct(h.ref,null,l),p.push(l.ref,l.__c||f,l)),k==null&&f!=null&&(k=f),(v=!!(4&l.__u))||h.__k===l.__k?d=os(l,d,t,v):typeof l.type=="function"&&m!==void 0?d=m:f&&(d=f.nextSibling),l.__u&=-7);return n.__e=k,d}function sr(t,e,n,s,i){var r,o,a,d,u,p=n.length,c=p,h=0;for(t.__k=new Array(i),r=0;r<i;r++)(o=e[r])!=null&&typeof o!="boolean"&&typeof o!="function"?(d=r+h,(o=t.__k[r]=typeof o=="string"||typeof o=="number"||typeof o=="bigint"||o.constructor==String?Pe(null,o,null,null,null):We(o)?Pe(qe,{children:o},null,null,null):o.constructor==null&&o.__b>0?Pe(o.type,o.props,o.key,o.ref?o.ref:null,o.__v):o).__=t,o.__b=t.__b+1,a=null,(u=o.__i=ir(o,n,d,c))!=-1&&(c--,(a=n[u])&&(a.__u|=2)),a==null||a.__v==null?(u==-1&&(i>p?h--:i<p&&h++),typeof o.type!="function"&&(o.__u|=4)):u!=d&&(u==d-1?h--:u==d+1?h++:(u>d?h--:h++,o.__u|=4))):t.__k[r]=null;if(c)for(r=0;r<p;r++)(a=n[r])!=null&&(2&a.__u)==0&&(a.__e==s&&(s=ge(a)),ls(a,a));return s}function os(t,e,n,s){var i,r;if(typeof t.type=="function"){for(i=t.__k,r=0;i&&r<i.length;r++)i[r]&&(i[r].__=t,e=os(i[r],e,n,s));return e}t.__e!=e&&(s&&(e&&t.type&&!e.parentNode&&(e=ge(t)),n.insertBefore(t.__e,e||null)),e=t.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function ir(t,e,n,s){var i,r,o,a=t.key,d=t.type,u=e[n],p=u!=null&&(2&u.__u)==0;if(u===null&&t.key==null||p&&a==u.key&&d==u.type)return n;if(s>(p?1:0)){for(i=n-1,r=n+1;i>=0||r<e.length;)if((u=e[o=i>=0?i--:r++])!=null&&(2&u.__u)==0&&a==u.key&&d==u.type)return o}return-1}function sn(t,e,n){e[0]=="-"?t.setProperty(e,n??""):t[e]=n==null?"":typeof n!="number"||nr.test(e)?n:n+"px"}function Ae(t,e,n,s,i){var r,o;e:if(e=="style")if(typeof n=="string")t.style.cssText=n;else{if(typeof s=="string"&&(t.style.cssText=s=""),s)for(e in s)n&&e in n||sn(t.style,e,"");if(n)for(e in n)s&&n[e]==s[e]||sn(t.style,e,n[e])}else if(e[0]=="o"&&e[1]=="n")r=e!=(e=e.replace(ns,"$1")),o=e.toLowerCase(),e=o in t||e=="onFocusOut"||e=="onFocusIn"?o.slice(2):e.slice(2),t.l||(t.l={}),t.l[e+r]=n,n?s?n.u=s.u:(n.u=Et,t.addEventListener(e,r?lt:ct,r)):t.removeEventListener(e,r?lt:ct,r);else{if(i=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in t)try{t[e]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&e[4]!="-"?t.removeAttribute(e):t.setAttribute(e,e=="popover"&&n==1?"":n))}}function rn(t){return function(e){if(this.l){var n=this.l[e.type+t];if(e.t==null)e.t=Et++;else if(e.t<n.u)return;return n(N.event?N.event(e):e)}}}function xt(t,e,n,s,i,r,o,a,d,u){var p,c,h,l,f,k,m,v,E,I,x,y,S,M,P,w,_,b=e.type;if(e.constructor!=null)return null;128&n.__u&&(d=!!(32&n.__u),r=[a=e.__e=n.__e]),(p=N.__b)&&p(e);e:if(typeof b=="function")try{if(v=e.props,E="prototype"in b&&b.prototype.render,I=(p=b.contextType)&&s[p.__c],x=p?I?I.props.value:p.__:s,n.__c?m=(c=e.__c=n.__c).__=c.__E:(E?e.__c=c=new b(v,x):(e.__c=c=new Te(v,x),c.constructor=b,c.render=or),I&&I.sub(c),c.props=v,c.state||(c.state={}),c.context=x,c.__n=s,h=c.__d=!0,c.__h=[],c._sb=[]),E&&c.__s==null&&(c.__s=c.state),E&&b.getDerivedStateFromProps!=null&&(c.__s==c.state&&(c.__s=te({},c.__s)),te(c.__s,b.getDerivedStateFromProps(v,c.__s))),l=c.props,f=c.state,c.__v=e,h)E&&b.getDerivedStateFromProps==null&&c.componentWillMount!=null&&c.componentWillMount(),E&&c.componentDidMount!=null&&c.__h.push(c.componentDidMount);else{if(E&&b.getDerivedStateFromProps==null&&v!==l&&c.componentWillReceiveProps!=null&&c.componentWillReceiveProps(v,x),!c.__e&&c.shouldComponentUpdate!=null&&c.shouldComponentUpdate(v,c.__s,x)===!1||e.__v==n.__v){for(e.__v!=n.__v&&(c.props=v,c.state=c.__s,c.__d=!1),e.__e=n.__e,e.__k=n.__k,e.__k.some(function(T){T&&(T.__=e)}),y=0;y<c._sb.length;y++)c.__h.push(c._sb[y]);c._sb=[],c.__h.length&&o.push(c);break e}c.componentWillUpdate!=null&&c.componentWillUpdate(v,c.__s,x),E&&c.componentDidUpdate!=null&&c.__h.push(function(){c.componentDidUpdate(l,f,k)})}if(c.context=x,c.props=v,c.__P=t,c.__e=!1,S=N.__r,M=0,E){for(c.state=c.__s,c.__d=!1,S&&S(e),p=c.render(c.props,c.state,c.context),P=0;P<c._sb.length;P++)c.__h.push(c._sb[P]);c._sb=[]}else do c.__d=!1,S&&S(e),p=c.render(c.props,c.state,c.context),c.state=c.__s;while(c.__d&&++M<25);c.state=c.__s,c.getChildContext!=null&&(s=te(te({},s),c.getChildContext())),E&&!h&&c.getSnapshotBeforeUpdate!=null&&(k=c.getSnapshotBeforeUpdate(l,f)),w=p,p!=null&&p.type===qe&&p.key==null&&(w=cs(p.props.children)),a=rs(t,We(w)?w:[w],e,n,s,i,r,o,a,d,u),c.base=e.__e,e.__u&=-161,c.__h.length&&o.push(c),m&&(c.__E=c.__=null)}catch(T){if(e.__v=null,d||r!=null)if(T.then){for(e.__u|=d?160:128;a&&a.nodeType==8&&a.nextSibling;)a=a.nextSibling;r[r.indexOf(a)]=null,e.__e=a}else{for(_=r.length;_--;)It(r[_]);ut(e)}else e.__e=n.__e,e.__k=n.__k,T.then||ut(e);N.__e(T,e,n)}else r==null&&e.__v==n.__v?(e.__k=n.__k,e.__e=n.__e):a=e.__e=rr(n.__e,e,n,s,i,r,o,d,u);return(p=N.diffed)&&p(e),128&e.__u?void 0:a}function ut(t){t&&t.__c&&(t.__c.__e=!0),t&&t.__k&&t.__k.forEach(ut)}function as(t,e,n){for(var s=0;s<n.length;s++)Ct(n[s],n[++s],n[++s]);N.__c&&N.__c(e,t),t.some(function(i){try{t=i.__h,i.__h=[],t.some(function(r){r.call(i)})}catch(r){N.__e(r,i.__v)}})}function cs(t){return typeof t!="object"||t==null||t.__b&&t.__b>0?t:We(t)?t.map(cs):te({},t)}function rr(t,e,n,s,i,r,o,a,d){var u,p,c,h,l,f,k,m=n.props,v=e.props,E=e.type;if(E=="svg"?i="http://www.w3.org/2000/svg":E=="math"?i="http://www.w3.org/1998/Math/MathML":i||(i="http://www.w3.org/1999/xhtml"),r!=null){for(u=0;u<r.length;u++)if((l=r[u])&&"setAttribute"in l==!!E&&(E?l.localName==E:l.nodeType==3)){t=l,r[u]=null;break}}if(t==null){if(E==null)return document.createTextNode(v);t=document.createElementNS(i,E,v.is&&v),a&&(N.__m&&N.__m(e,r),a=!1),r=null}if(E==null)m===v||a&&t.data==v||(t.data=v);else{if(r=r&&je.call(t.childNodes),m=n.props||Ie,!a&&r!=null)for(m={},u=0;u<t.attributes.length;u++)m[(l=t.attributes[u]).name]=l.value;for(u in m)if(l=m[u],u!="children"){if(u=="dangerouslySetInnerHTML")c=l;else if(!(u in v)){if(u=="value"&&"defaultValue"in v||u=="checked"&&"defaultChecked"in v)continue;Ae(t,u,null,l,i)}}for(u in v)l=v[u],u=="children"?h=l:u=="dangerouslySetInnerHTML"?p=l:u=="value"?f=l:u=="checked"?k=l:a&&typeof l!="function"||m[u]===l||Ae(t,u,l,m[u],i);if(p)a||c&&(p.__html==c.__html||p.__html==t.innerHTML)||(t.innerHTML=p.__html),e.__k=[];else if(c&&(t.innerHTML=""),rs(e.type=="template"?t.content:t,We(h)?h:[h],e,n,s,E=="foreignObject"?"http://www.w3.org/1999/xhtml":i,r,o,r?r[0]:n.__k&&ge(n,0),a,d),r!=null)for(u=r.length;u--;)It(r[u]);a||(u="value",E=="progress"&&f==null?t.removeAttribute("value"):f!=null&&(f!==t[u]||E=="progress"&&!f||E=="option"&&f!=m[u])&&Ae(t,u,f,m[u],i),u="checked",k!=null&&k!=t[u]&&Ae(t,u,k,m[u],i))}return t}function Ct(t,e,n){try{if(typeof t=="function"){var s=typeof t.__u=="function";s&&t.__u(),s&&e==null||(t.__u=t(e))}else t.current=e}catch(i){N.__e(i,n)}}function ls(t,e,n){var s,i;if(N.unmount&&N.unmount(t),(s=t.ref)&&(s.current&&s.current!=t.__e||Ct(s,null,e)),(s=t.__c)!=null){if(s.componentWillUnmount)try{s.componentWillUnmount()}catch(r){N.__e(r,e)}s.base=s.__P=null}if(s=t.__k)for(i=0;i<s.length;i++)s[i]&&ls(s[i],e,n||typeof t.type!="function");n||It(t.__e),t.__c=t.__=t.__e=void 0}function or(t,e,n){return this.constructor(t,n)}function dt(t,e,n){var s,i,r,o;e==document&&(e=document.documentElement),N.__&&N.__(t,e),i=(s=!1)?null:e.__k,r=[],o=[],xt(e,t=e.__k=O(qe,null,[t]),i||Ie,Ie,e.namespaceURI,i?null:e.firstChild?je.call(e.childNodes):null,r,i?i.__e:e.firstChild,s,o),as(r,t,o)}je=ss.slice,N={__e:function(t,e,n,s){for(var i,r,o;e=e.__;)if((i=e.__c)&&!i.__)try{if((r=i.constructor)&&r.getDerivedStateFromError!=null&&(i.setState(r.getDerivedStateFromError(t)),o=i.__d),i.componentDidCatch!=null&&(i.componentDidCatch(t,s||{}),o=i.__d),o)return i.__E=i}catch(a){t=a}throw t}},Xn=0,Te.prototype.setState=function(t,e){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=te({},this.state),typeof t=="function"&&(t=t(te({},n),this.props)),t&&te(n,t),t!=null&&this.__v&&(e&&this._sb.push(e),nn(this))},Te.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),nn(this))},Te.prototype.render=qe,le=[],es=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,ts=function(t,e){return t.__v.__b-e.__v.__b},Ne.__r=0,ns=/(PointerCapture)$|Capture$/i,Et=0,ct=rn(!1),lt=rn(!0);var De,B,tt,on,ht=0,us=[],j=N,an=j.__b,cn=j.__r,ln=j.diffed,un=j.__c,dn=j.unmount,hn=j.__;function ds(t,e){j.__h&&j.__h(B,t,ht||e),ht=0;var n=B.__H||(B.__H={__:[],__h:[]});return t>=n.__.length&&n.__.push({}),n.__[t]}function fn(t){return ht=1,ar(hs,t)}function ar(t,e,n){var s=ds(De++,2);if(s.t=t,!s.__c&&(s.__=[hs(void 0,e),function(a){var d=s.__N?s.__N[0]:s.__[0],u=s.t(d,a);d!==u&&(s.__N=[u,s.__[1]],s.__c.setState({}))}],s.__c=B,!B.__f)){var i=function(a,d,u){if(!s.__c.__H)return!0;var p=s.__c.__H.__.filter(function(h){return!!h.__c});if(p.every(function(h){return!h.__N}))return!r||r.call(this,a,d,u);var c=s.__c.props!==a;return p.forEach(function(h){if(h.__N){var l=h.__[0];h.__=h.__N,h.__N=void 0,l!==h.__[0]&&(c=!0)}}),r&&r.call(this,a,d,u)||c};B.__f=!0;var r=B.shouldComponentUpdate,o=B.componentWillUpdate;B.componentWillUpdate=function(a,d,u){if(this.__e){var p=r;r=void 0,i(a,d,u),r=p}o&&o.call(this,a,d,u)},B.shouldComponentUpdate=i}return s.__N||s.__}function cr(t,e){var n=ds(De++,3);!j.__s&&dr(n.__H,e)&&(n.__=t,n.u=e,B.__H.__h.push(n))}function lr(){for(var t;t=us.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(Oe),t.__H.__h.forEach(ft),t.__H.__h=[]}catch(e){t.__H.__h=[],j.__e(e,t.__v)}}j.__b=function(t){B=null,an&&an(t)},j.__=function(t,e){t&&e.__k&&e.__k.__m&&(t.__m=e.__k.__m),hn&&hn(t,e)},j.__r=function(t){cn&&cn(t),De=0;var e=(B=t.__c).__H;e&&(tt===B?(e.__h=[],B.__h=[],e.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(e.__h.forEach(Oe),e.__h.forEach(ft),e.__h=[],De=0)),tt=B},j.diffed=function(t){ln&&ln(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(us.push(e)!==1&&on===j.requestAnimationFrame||((on=j.requestAnimationFrame)||ur)(lr)),e.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),tt=B=null},j.__c=function(t,e){e.some(function(n){try{n.__h.forEach(Oe),n.__h=n.__h.filter(function(s){return!s.__||ft(s)})}catch(s){e.some(function(i){i.__h&&(i.__h=[])}),e=[],j.__e(s,n.__v)}}),un&&un(t,e)},j.unmount=function(t){dn&&dn(t);var e,n=t.__c;n&&n.__H&&(n.__H.__.forEach(function(s){try{Oe(s)}catch(i){e=i}}),n.__H=void 0,e&&j.__e(e,n.__v))};var pn=typeof requestAnimationFrame=="function";function ur(t){var e,n=function(){clearTimeout(s),pn&&cancelAnimationFrame(e),setTimeout(t)},s=setTimeout(n,35);pn&&(e=requestAnimationFrame(n))}function Oe(t){var e=B,n=t.__c;typeof n=="function"&&(t.__c=void 0,n()),B=e}function ft(t){var e=B;t.__c=t.__(),B=e}function dr(t,e){return!t||t.length!==e.length||e.some(function(n,s){return n!==t[s]})}function hs(t,e){return typeof e=="function"?e(t):e}const hr=".-cbwsdk-css-reset .-gear-container{margin-left:16px !important;margin-right:9px !important;display:flex;align-items:center;justify-content:center;width:24px;height:24px;transition:opacity .25s}.-cbwsdk-css-reset .-gear-container *{user-select:none}.-cbwsdk-css-reset .-gear-container svg{opacity:0;position:absolute}.-cbwsdk-css-reset .-gear-icon{height:12px;width:12px;z-index:10000}.-cbwsdk-css-reset .-cbwsdk-snackbar{align-items:flex-end;display:flex;flex-direction:column;position:fixed;right:0;top:0;z-index:2147483647}.-cbwsdk-css-reset .-cbwsdk-snackbar *{user-select:none}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance{display:flex;flex-direction:column;margin:8px 16px 0 16px;overflow:visible;text-align:left;transform:translateX(0);transition:opacity .25s,transform .25s}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-header:hover .-gear-container svg{opacity:1}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-header{display:flex;align-items:center;background:#fff;overflow:hidden;border:1px solid #e7ebee;box-sizing:border-box;border-radius:8px;cursor:pointer}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-header-cblogo{margin:8px 8px 8px 8px}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-header *{cursor:pointer}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-header-message{color:#000;font-size:13px;line-height:1.5;user-select:none}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu{background:#fff;transition:opacity .25s ease-in-out,transform .25s linear,visibility 0s;visibility:hidden;border:1px solid #e7ebee;box-sizing:border-box;border-radius:8px;opacity:0;flex-direction:column;padding-left:8px;padding-right:8px}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item:last-child{margin-bottom:8px !important}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item:hover{background:#f5f7f8;border-radius:6px;transition:background .25s}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item:hover span{color:#050f19;transition:color .25s}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item:hover svg path{fill:#000;transition:fill .25s}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item{visibility:inherit;height:35px;margin-top:8px;margin-bottom:0;display:flex;flex-direction:row;align-items:center;padding:8px;cursor:pointer}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item *{visibility:inherit;cursor:pointer}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item-is-red:hover{background:rgba(223,95,103,.2);transition:background .25s}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item-is-red:hover *{cursor:pointer}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item-is-red:hover svg path{fill:#df5f67;transition:fill .25s}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item-is-red:hover span{color:#df5f67;transition:color .25s}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item-info{color:#aaa;font-size:13px;margin:0 8px 0 32px;position:absolute}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-hidden{opacity:0;text-align:left;transform:translateX(25%);transition:opacity .5s linear}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-expanded .-cbwsdk-snackbar-instance-menu{opacity:1;display:flex;transform:translateY(8px);visibility:visible}",fr="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTEuNDkyIDEwLjQxOWE4LjkzIDguOTMgMCAwMTguOTMtOC45M2gxMS4xNjNhOC45MyA4LjkzIDAgMDE4LjkzIDguOTN2MTEuMTYzYTguOTMgOC45MyAwIDAxLTguOTMgOC45M0gxMC40MjJhOC45MyA4LjkzIDAgMDEtOC45My04LjkzVjEwLjQxOXoiIGZpbGw9IiMxNjUyRjAiLz48cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTEwLjQxOSAwSDIxLjU4QzI3LjMzNSAwIDMyIDQuNjY1IDMyIDEwLjQxOVYyMS41OEMzMiAyNy4zMzUgMjcuMzM1IDMyIDIxLjU4MSAzMkgxMC40MkM0LjY2NSAzMiAwIDI3LjMzNSAwIDIxLjU4MVYxMC40MkMwIDQuNjY1IDQuNjY1IDAgMTAuNDE5IDB6bTAgMS40ODhhOC45MyA4LjkzIDAgMDAtOC45MyA4LjkzdjExLjE2M2E4LjkzIDguOTMgMCAwMDguOTMgOC45M0gyMS41OGE4LjkzIDguOTMgMCAwMDguOTMtOC45M1YxMC40MmE4LjkzIDguOTMgMCAwMC04LjkzLTguOTNIMTAuNDJ6IiBmaWxsPSIjZmZmIi8+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xNS45OTggMjYuMDQ5Yy01LjU0OSAwLTEwLjA0Ny00LjQ5OC0xMC4wNDctMTAuMDQ3IDAtNS41NDggNC40OTgtMTAuMDQ2IDEwLjA0Ny0xMC4wNDYgNS41NDggMCAxMC4wNDYgNC40OTggMTAuMDQ2IDEwLjA0NiAwIDUuNTQ5LTQuNDk4IDEwLjA0Ny0xMC4wNDYgMTAuMDQ3eiIgZmlsbD0iI2ZmZiIvPjxwYXRoIGQ9Ik0xMi43NjIgMTQuMjU0YzAtLjgyMi42NjctMS40ODkgMS40ODktMS40ODloMy40OTdjLjgyMiAwIDEuNDg4LjY2NiAxLjQ4OCAxLjQ4OXYzLjQ5N2MwIC44MjItLjY2NiAxLjQ4OC0xLjQ4OCAxLjQ4OGgtMy40OTdhMS40ODggMS40ODggMCAwMS0xLjQ4OS0xLjQ4OHYtMy40OTh6IiBmaWxsPSIjMTY1MkYwIi8+PC9zdmc+",pr="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIiIGhlaWdodD0iMTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTEyIDYuNzV2LTEuNWwtMS43Mi0uNTdjLS4wOC0uMjctLjE5LS41Mi0uMzItLjc3bC44MS0xLjYyLTEuMDYtMS4wNi0xLjYyLjgxYy0uMjQtLjEzLS41LS4yNC0uNzctLjMyTDYuNzUgMGgtMS41bC0uNTcgMS43MmMtLjI3LjA4LS41My4xOS0uNzcuMzJsLTEuNjItLjgxLTEuMDYgMS4wNi44MSAxLjYyYy0uMTMuMjQtLjI0LjUtLjMyLjc3TDAgNS4yNXYxLjVsMS43Mi41N2MuMDguMjcuMTkuNTMuMzIuNzdsLS44MSAxLjYyIDEuMDYgMS4wNiAxLjYyLS44MWMuMjQuMTMuNS4yMy43Ny4zMkw1LjI1IDEyaDEuNWwuNTctMS43MmMuMjctLjA4LjUyLS4xOS43Ny0uMzJsMS42Mi44MSAxLjA2LTEuMDYtLjgxLTEuNjJjLjEzLS4yNC4yMy0uNS4zMi0uNzdMMTIgNi43NXpNNiA4LjVhMi41IDIuNSAwIDAxMC01IDIuNSAyLjUgMCAwMTAgNXoiIGZpbGw9IiMwNTBGMTkiLz48L3N2Zz4=";class fs{constructor(){this.items=new Map,this.nextItemKey=0,this.root=null,this.darkMode=Yn()}attach(e){this.root=document.createElement("div"),this.root.className="-cbwsdk-snackbar-root",e.appendChild(this.root),this.render()}presentItem(e){const n=this.nextItemKey++;return this.items.set(n,e),this.render(),()=>{this.items.delete(n),this.render()}}clear(){this.items.clear(),this.render()}render(){this.root&&dt(O("div",null,O(ps,{darkMode:this.darkMode},Array.from(this.items.entries()).map(([e,n])=>O(gr,Object.assign({},n,{key:e}))))),this.root)}}const ps=t=>O("div",{class:ve("-cbwsdk-snackbar-container")},O("style",null,hr),O("div",{class:"-cbwsdk-snackbar"},t.children)),gr=({autoExpand:t,message:e,menuItems:n})=>{const[s,i]=fn(!0),[r,o]=fn(t??!1);cr(()=>{const d=[window.setTimeout(()=>{i(!1)},1),window.setTimeout(()=>{o(!0)},1e4)];return()=>{d.forEach(window.clearTimeout)}});const a=()=>{o(!r)};return O("div",{class:ve("-cbwsdk-snackbar-instance",s&&"-cbwsdk-snackbar-instance-hidden",r&&"-cbwsdk-snackbar-instance-expanded")},O("div",{class:"-cbwsdk-snackbar-instance-header",onClick:a},O("img",{src:fr,class:"-cbwsdk-snackbar-instance-header-cblogo"})," ",O("div",{class:"-cbwsdk-snackbar-instance-header-message"},e),O("div",{class:"-gear-container"},!r&&O("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},O("circle",{cx:"12",cy:"12",r:"12",fill:"#F5F7F8"})),O("img",{src:pr,class:"-gear-icon",title:"Expand"}))),n&&n.length>0&&O("div",{class:"-cbwsdk-snackbar-instance-menu"},n.map((d,u)=>O("div",{class:ve("-cbwsdk-snackbar-instance-menu-item",d.isRed&&"-cbwsdk-snackbar-instance-menu-item-is-red"),onClick:d.onClick,key:u},O("svg",{width:d.svgWidth,height:d.svgHeight,viewBox:"0 0 10 11",fill:"none",xmlns:"http://www.w3.org/2000/svg"},O("path",{"fill-rule":d.defaultFillRule,"clip-rule":d.defaultClipRule,d:d.path,fill:"#AAAAAA"})),O("span",{class:ve("-cbwsdk-snackbar-instance-menu-item-info",d.isRed&&"-cbwsdk-snackbar-instance-menu-item-info-is-red")},d.info)))))},gs="M5.00008 0.96875C6.73133 0.96875 8.23758 1.94375 9.00008 3.375L10.0001 2.375V5.5H9.53133H7.96883H6.87508L7.80633 4.56875C7.41258 3.3875 6.31258 2.53125 5.00008 2.53125C3.76258 2.53125 2.70633 3.2875 2.25633 4.36875L0.812576 3.76875C1.50008 2.125 3.11258 0.96875 5.00008 0.96875ZM2.19375 6.43125C2.5875 7.6125 3.6875 8.46875 5 8.46875C6.2375 8.46875 7.29375 7.7125 7.74375 6.63125L9.1875 7.23125C8.5 8.875 6.8875 10.0312 5 10.0312C3.26875 10.0312 1.7625 9.05625 1 7.625L0 8.625V5.5H0.46875H2.03125H3.125L2.19375 6.43125Z";class mr{constructor(){this.attached=!1,this.snackbar=new fs}attach(){if(this.attached)throw new Error("Coinbase Wallet SDK UI is already attached");const e=document.documentElement,n=document.createElement("div");n.className="-cbwsdk-css-reset",e.appendChild(n),this.snackbar.attach(n),this.attached=!0,Jn()}showConnecting(e){let n;return e.isUnlinkedErrorState?n={autoExpand:!0,message:"Connection lost",menuItems:[{isRed:!1,info:"Reset connection",svgWidth:"10",svgHeight:"11",path:"M5.00008 0.96875C6.73133 0.96875 8.23758 1.94375 9.00008 3.375L10.0001 2.375V5.5H9.53133H7.96883H6.87508L7.80633 4.56875C7.41258 3.3875 6.31258 2.53125 5.00008 2.53125C3.76258 2.53125 2.70633 3.2875 2.25633 4.36875L0.812576 3.76875C1.50008 2.125 3.11258 0.96875 5.00008 0.96875ZM2.19375 6.43125C2.5875 7.6125 3.6875 8.46875 5 8.46875C6.2375 8.46875 7.29375 7.7125 7.74375 6.63125L9.1875 7.23125C8.5 8.875 6.8875 10.0312 5 10.0312C3.26875 10.0312 1.7625 9.05625 1 7.625L0 8.625V5.5H0.46875H2.03125H3.125L2.19375 6.43125Z",defaultFillRule:"evenodd",defaultClipRule:"evenodd",onClick:e.onResetConnection}]}:n={message:"Confirm on phone",menuItems:[{isRed:!0,info:"Cancel transaction",svgWidth:"11",svgHeight:"11",path:"M10.3711 1.52346L9.21775 0.370117L5.37109 4.21022L1.52444 0.370117L0.371094 1.52346L4.2112 5.37012L0.371094 9.21677L1.52444 10.3701L5.37109 6.53001L9.21775 10.3701L10.3711 9.21677L6.53099 5.37012L10.3711 1.52346Z",defaultFillRule:"inherit",defaultClipRule:"inherit",onClick:e.onCancel},{isRed:!1,info:"Reset connection",svgWidth:"10",svgHeight:"11",path:gs,defaultFillRule:"evenodd",defaultClipRule:"evenodd",onClick:e.onResetConnection}]},this.snackbar.presentItem(n)}}const _r=".-cbwsdk-css-reset .-cbwsdk-redirect-dialog-backdrop{position:fixed;top:0;left:0;right:0;bottom:0;transition:opacity .25s;background-color:rgba(10,11,13,.5)}.-cbwsdk-css-reset .-cbwsdk-redirect-dialog-backdrop-hidden{opacity:0}.-cbwsdk-css-reset .-cbwsdk-redirect-dialog-box{display:block;position:fixed;top:50%;left:50%;transform:translate(-50%, -50%);padding:20px;border-radius:8px;background-color:#fff;color:#0a0b0d}.-cbwsdk-css-reset .-cbwsdk-redirect-dialog-box p{display:block;font-weight:400;font-size:14px;line-height:20px;padding-bottom:12px;color:#5b636e}.-cbwsdk-css-reset .-cbwsdk-redirect-dialog-box button{appearance:none;border:none;background:none;color:#0052ff;padding:0;text-decoration:none;display:block;font-weight:600;font-size:16px;line-height:24px}.-cbwsdk-css-reset .-cbwsdk-redirect-dialog-box.dark{background-color:#0a0b0d;color:#fff}.-cbwsdk-css-reset .-cbwsdk-redirect-dialog-box.dark button{color:#0052ff}.-cbwsdk-css-reset .-cbwsdk-redirect-dialog-box.light{background-color:#fff;color:#0a0b0d}.-cbwsdk-css-reset .-cbwsdk-redirect-dialog-box.light button{color:#0052ff}";class br{constructor(){this.root=null,this.darkMode=Yn()}attach(){const e=document.documentElement;this.root=document.createElement("div"),this.root.className="-cbwsdk-css-reset",e.appendChild(this.root),Jn()}present(e){this.render(e)}clear(){this.render(null)}render(e){this.root&&(dt(null,this.root),e&&dt(O(yr,Object.assign({},e,{onDismiss:()=>{this.clear()},darkMode:this.darkMode})),this.root))}}const yr=({title:t,buttonText:e,darkMode:n,onButtonClick:s,onDismiss:i})=>{const r=n?"dark":"light";return O(ps,{darkMode:n},O("div",{class:"-cbwsdk-redirect-dialog"},O("style",null,_r),O("div",{class:"-cbwsdk-redirect-dialog-backdrop",onClick:i}),O("div",{class:ve("-cbwsdk-redirect-dialog-box",r)},O("p",null,t),O("button",{onClick:s},e))))},wr="https://keys.coinbase.com/connect",vr="https://rpc.wallet.coinbase.com",gn="https://www.walletlink.org",kr="https://go.cb-w.com/walletlink";class mn{constructor(){this.attached=!1,this.redirectDialog=new br}attach(){if(this.attached)throw new Error("Coinbase Wallet SDK UI is already attached");this.redirectDialog.attach(),this.attached=!0}redirectToCoinbaseWallet(e){const n=new URL(kr);n.searchParams.append("redirect_url",Xi().href),e&&n.searchParams.append("wl_url",e);const s=document.createElement("a");s.target="cbw-opener",s.href=n.href,s.rel="noreferrer noopener",s.click()}openCoinbaseWalletDeeplink(e){this.redirectToCoinbaseWallet(e),setTimeout(()=>{this.redirectDialog.present({title:"Redirecting to Coinbase Wallet...",buttonText:"Open",onButtonClick:()=>{this.redirectToCoinbaseWallet(e)}})},99)}showConnecting(e){return()=>{this.redirectDialog.clear()}}}class ee{constructor(e){this.chainCallbackParams={chainId:"",jsonRpcUrl:""},this.isMobileWeb=er(),this.linkedUpdated=r=>{this.isLinked=r;const o=this.storage.getItem(at);if(r&&(this._session.linked=r),this.isUnlinkedErrorState=!1,o){const a=o.split(" "),d=this.storage.getItem("IsStandaloneSigning")==="true";a[0]!==""&&!r&&this._session.linked&&!d&&(this.isUnlinkedErrorState=!0)}},this.metadataUpdated=(r,o)=>{this.storage.setItem(r,o)},this.chainUpdated=(r,o)=>{this.chainCallbackParams.chainId===r&&this.chainCallbackParams.jsonRpcUrl===o||(this.chainCallbackParams={chainId:r,jsonRpcUrl:o},this.chainCallback&&this.chainCallback(o,Number.parseInt(r,10)))},this.accountUpdated=r=>{this.accountsCallback&&this.accountsCallback([r]),ee.accountRequestCallbackIds.size>0&&(Array.from(ee.accountRequestCallbackIds.values()).forEach(o=>{this.invokeCallback(o,{method:"requestEthereumAccounts",result:[r]})}),ee.accountRequestCallbackIds.clear())},this.resetAndReload=this.resetAndReload.bind(this),this.linkAPIUrl=e.linkAPIUrl,this.storage=e.storage,this.metadata=e.metadata,this.accountsCallback=e.accountsCallback,this.chainCallback=e.chainCallback;const{session:n,ui:s,connection:i}=this.subscribe();this._session=n,this.connection=i,this.relayEventManager=new Ji,this.ui=s,this.ui.attach()}subscribe(){const e=fe.load(this.storage)||fe.create(this.storage),{linkAPIUrl:n}=this,s=new Yi({session:e,linkAPIUrl:n,listener:this}),i=this.isMobileWeb?new mn:new mr;return s.connect(),{session:e,ui:i,connection:s}}resetAndReload(){this.connection.destroy().then(()=>{const e=fe.load(this.storage);e?.id===this._session.id&&J.clearAll(),document.location.reload()}).catch(e=>{})}signEthereumTransaction(e){return this.sendRequest({method:"signEthereumTransaction",params:{fromAddress:e.fromAddress,toAddress:e.toAddress,weiValue:G(e.weiValue),data:ye(e.data,!0),nonce:e.nonce,gasPriceInWei:e.gasPriceInWei?G(e.gasPriceInWei):null,maxFeePerGas:e.gasPriceInWei?G(e.gasPriceInWei):null,maxPriorityFeePerGas:e.gasPriceInWei?G(e.gasPriceInWei):null,gasLimit:e.gasLimit?G(e.gasLimit):null,chainId:e.chainId,shouldSubmit:!1}})}signAndSubmitEthereumTransaction(e){return this.sendRequest({method:"signEthereumTransaction",params:{fromAddress:e.fromAddress,toAddress:e.toAddress,weiValue:G(e.weiValue),data:ye(e.data,!0),nonce:e.nonce,gasPriceInWei:e.gasPriceInWei?G(e.gasPriceInWei):null,maxFeePerGas:e.maxFeePerGas?G(e.maxFeePerGas):null,maxPriorityFeePerGas:e.maxPriorityFeePerGas?G(e.maxPriorityFeePerGas):null,gasLimit:e.gasLimit?G(e.gasLimit):null,chainId:e.chainId,shouldSubmit:!0}})}submitEthereumTransaction(e,n){return this.sendRequest({method:"submitEthereumTransaction",params:{signedTransaction:ye(e,!0),chainId:n}})}getWalletLinkSession(){return this._session}sendRequest(e){let n=null;const s=ce(8),i=r=>{this.publishWeb3RequestCanceledEvent(s),this.handleErrorResponse(s,e.method,r),n?.()};return new Promise((r,o)=>{n=this.ui.showConnecting({isUnlinkedErrorState:this.isUnlinkedErrorState,onCancel:i,onResetConnection:this.resetAndReload}),this.relayEventManager.callbacks.set(s,a=>{if(n?.(),z(a))return o(new Error(a.errorMessage));r(a)}),this.publishWeb3RequestEvent(s,e)})}publishWeb3RequestEvent(e,n){const s={type:"WEB3_REQUEST",id:e,request:n};this.publishEvent("Web3Request",s,!0).then(i=>{}).catch(i=>{this.handleWeb3ResponseMessage(s.id,{method:n.method,errorMessage:i.message})}),this.isMobileWeb&&this.openCoinbaseWalletDeeplink(n.method)}openCoinbaseWalletDeeplink(e){if(this.ui instanceof mn)switch(e){case"requestEthereumAccounts":case"switchEthereumChain":return;default:window.addEventListener("blur",()=>{window.addEventListener("focus",()=>{this.connection.checkUnseenEvents()},{once:!0})},{once:!0}),this.ui.openCoinbaseWalletDeeplink();break}}publishWeb3RequestCanceledEvent(e){const n={type:"WEB3_REQUEST_CANCELED",id:e};this.publishEvent("Web3RequestCanceled",n,!1).then()}publishEvent(e,n,s){return this.connection.publishEvent(e,n,s)}handleWeb3ResponseMessage(e,n){if(n.method==="requestEthereumAccounts"){ee.accountRequestCallbackIds.forEach(s=>this.invokeCallback(s,n)),ee.accountRequestCallbackIds.clear();return}this.invokeCallback(e,n)}handleErrorResponse(e,n,s){var i;const r=(i=s?.message)!==null&&i!==void 0?i:"Unspecified error message.";this.handleWeb3ResponseMessage(e,{method:n,errorMessage:r})}invokeCallback(e,n){const s=this.relayEventManager.callbacks.get(e);s&&(s(n),this.relayEventManager.callbacks.delete(e))}requestEthereumAccounts(){const{appName:e,appLogoUrl:n}=this.metadata,s={method:"requestEthereumAccounts",params:{appName:e,appLogoUrl:n}},i=ce(8);return new Promise((r,o)=>{this.relayEventManager.callbacks.set(i,a=>{if(z(a))return o(new Error(a.errorMessage));r(a)}),ee.accountRequestCallbackIds.add(i),this.publishWeb3RequestEvent(i,s)})}watchAsset(e,n,s,i,r,o){const a={method:"watchAsset",params:{type:e,options:{address:n,symbol:s,decimals:i,image:r},chainId:o}};let d=null;const u=ce(8),p=c=>{this.publishWeb3RequestCanceledEvent(u),this.handleErrorResponse(u,a.method,c),d?.()};return d=this.ui.showConnecting({isUnlinkedErrorState:this.isUnlinkedErrorState,onCancel:p,onResetConnection:this.resetAndReload}),new Promise((c,h)=>{this.relayEventManager.callbacks.set(u,l=>{if(d?.(),z(l))return h(new Error(l.errorMessage));c(l)}),this.publishWeb3RequestEvent(u,a)})}addEthereumChain(e,n,s,i,r,o){const a={method:"addEthereumChain",params:{chainId:e,rpcUrls:n,blockExplorerUrls:i,chainName:r,iconUrls:s,nativeCurrency:o}};let d=null;const u=ce(8),p=c=>{this.publishWeb3RequestCanceledEvent(u),this.handleErrorResponse(u,a.method,c),d?.()};return d=this.ui.showConnecting({isUnlinkedErrorState:this.isUnlinkedErrorState,onCancel:p,onResetConnection:this.resetAndReload}),new Promise((c,h)=>{this.relayEventManager.callbacks.set(u,l=>{if(d?.(),z(l))return h(new Error(l.errorMessage));c(l)}),this.publishWeb3RequestEvent(u,a)})}switchEthereumChain(e,n){const s={method:"switchEthereumChain",params:Object.assign({chainId:e},{address:n})};let i=null;const r=ce(8),o=a=>{this.publishWeb3RequestCanceledEvent(r),this.handleErrorResponse(r,s.method,a),i?.()};return i=this.ui.showConnecting({isUnlinkedErrorState:this.isUnlinkedErrorState,onCancel:o,onResetConnection:this.resetAndReload}),new Promise((a,d)=>{this.relayEventManager.callbacks.set(r,u=>{if(i?.(),z(u)&&u.errorCode)return d(L.provider.custom({code:u.errorCode,message:"Unrecognized chain ID. Try adding the chain using addEthereumChain first."}));if(z(u))return d(new Error(u.errorMessage));a(u)}),this.publishWeb3RequestEvent(r,s)})}}ee.accountRequestCallbackIds=new Set;const _n="DefaultChainId",bn="DefaultJsonRpcUrl";class ms{constructor(e){this._relay=null,this._addresses=[],this.metadata=e.metadata,this._storage=new J("walletlink",gn),this.callback=e.callback||null;const n=this._storage.getItem(at);if(n){const s=n.split(" ");s[0]!==""&&(this._addresses=s.map(i=>ie(i)))}this.initializeRelay()}getSession(){const e=this.initializeRelay(),{id:n,secret:s}=e.getWalletLinkSession();return{id:n,secret:s}}async handshake(){await this._eth_requestAccounts()}get selectedAddress(){return this._addresses[0]||void 0}get jsonRpcUrl(){var e;return(e=this._storage.getItem(bn))!==null&&e!==void 0?e:void 0}set jsonRpcUrl(e){this._storage.setItem(bn,e)}updateProviderInfo(e,n){var s;this.jsonRpcUrl=e;const i=this.getChainId();this._storage.setItem(_n,n.toString(10)),we(n)!==i&&((s=this.callback)===null||s===void 0||s.call(this,"chainChanged",re(n)))}async watchAsset(e){const n=Array.isArray(e)?e[0]:e;if(!n.type)throw L.rpc.invalidParams("Type is required");if(n?.type!=="ERC20")throw L.rpc.invalidParams(`Asset of type '${n.type}' is not supported`);if(!n?.options)throw L.rpc.invalidParams("Options are required");if(!n?.options.address)throw L.rpc.invalidParams("Address is required");const s=this.getChainId(),{address:i,symbol:r,image:o,decimals:a}=n.options,u=await this.initializeRelay().watchAsset(n.type,i,r,a,o,s?.toString());return z(u)?!1:!!u.result}async addEthereumChain(e){var n,s;const i=e[0];if(((n=i.rpcUrls)===null||n===void 0?void 0:n.length)===0)throw L.rpc.invalidParams("please pass in at least 1 rpcUrl");if(!i.chainName||i.chainName.trim()==="")throw L.rpc.invalidParams("chainName is a required field");if(!i.nativeCurrency)throw L.rpc.invalidParams("nativeCurrency is a required field");const r=Number.parseInt(i.chainId,16);if(r===this.getChainId())return!1;const o=this.initializeRelay(),{rpcUrls:a=[],blockExplorerUrls:d=[],chainName:u,iconUrls:p=[],nativeCurrency:c}=i,h=await o.addEthereumChain(r.toString(),a,p,d,u,c);if(z(h))return!1;if(((s=h.result)===null||s===void 0?void 0:s.isApproved)===!0)return this.updateProviderInfo(a[0],r),null;throw L.rpc.internal("unable to add ethereum chain")}async switchEthereumChain(e){const n=e[0],s=Number.parseInt(n.chainId,16),r=await this.initializeRelay().switchEthereumChain(s.toString(10),this.selectedAddress||void 0);if(z(r))throw r;const o=r.result;return o.isApproved&&o.rpcUrl.length>0&&this.updateProviderInfo(o.rpcUrl,s),null}async cleanup(){this.callback=null,this._relay&&this._relay.resetAndReload(),this._storage.clear()}_setAddresses(e,n){var s;if(!Array.isArray(e))throw new Error("addresses is not an array");const i=e.map(r=>ie(r));JSON.stringify(i)!==JSON.stringify(this._addresses)&&(this._addresses=i,(s=this.callback)===null||s===void 0||s.call(this,"accountsChanged",i),this._storage.setItem(at,i.join(" ")))}async request(e){const n=e.params||[];switch(e.method){case"eth_accounts":return[...this._addresses];case"eth_coinbase":return this.selectedAddress||null;case"net_version":return this.getChainId().toString(10);case"eth_chainId":return re(this.getChainId());case"eth_requestAccounts":return this._eth_requestAccounts();case"eth_ecRecover":case"personal_ecRecover":return this.ecRecover(e);case"personal_sign":return this.personalSign(e);case"eth_signTransaction":return this._eth_signTransaction(n);case"eth_sendRawTransaction":return this._eth_sendRawTransaction(n);case"eth_sendTransaction":return this._eth_sendTransaction(n);case"eth_signTypedData_v1":case"eth_signTypedData_v3":case"eth_signTypedData_v4":case"eth_signTypedData":return this.signTypedData(e);case"wallet_addEthereumChain":return this.addEthereumChain(n);case"wallet_switchEthereumChain":return this.switchEthereumChain(n);case"wallet_watchAsset":return this.watchAsset(n);default:if(!this.jsonRpcUrl)throw L.rpc.internal("No RPC URL set for chain");return kt(e,this.jsonRpcUrl)}}_ensureKnownAddress(e){const n=ie(e);if(!this._addresses.map(i=>ie(i)).includes(n))throw new Error("Unknown Ethereum address")}_prepareTransactionParams(e){const n=e.from?ie(e.from):this.selectedAddress;if(!n)throw new Error("Ethereum address is unavailable");this._ensureKnownAddress(n);const s=e.to?ie(e.to):null,i=e.value!=null?_e(e.value):BigInt(0),r=e.data?ot(e.data):Buffer.alloc(0),o=e.nonce!=null?we(e.nonce):null,a=e.gasPrice!=null?_e(e.gasPrice):null,d=e.maxFeePerGas!=null?_e(e.maxFeePerGas):null,u=e.maxPriorityFeePerGas!=null?_e(e.maxPriorityFeePerGas):null,p=e.gas!=null?_e(e.gas):null,c=e.chainId?we(e.chainId):this.getChainId();return{fromAddress:n,toAddress:s,weiValue:i,data:r,nonce:o,gasPriceInWei:a,maxFeePerGas:d,maxPriorityFeePerGas:u,gasLimit:p,chainId:c}}async ecRecover(e){const{method:n,params:s}=e;if(!Array.isArray(s))throw L.rpc.invalidParams();const r=await this.initializeRelay().sendRequest({method:"ethereumAddressFromSignedMessage",params:{message:Ke(s[0]),signature:Ke(s[1]),addPrefix:n==="personal_ecRecover"}});if(z(r))throw r;return r.result}getChainId(){var e;return Number.parseInt((e=this._storage.getItem(_n))!==null&&e!==void 0?e:"1",10)}async _eth_requestAccounts(){var e,n;if(this._addresses.length>0)return(e=this.callback)===null||e===void 0||e.call(this,"connect",{chainId:re(this.getChainId())}),this._addresses;const i=await this.initializeRelay().requestEthereumAccounts();if(z(i))throw i;if(!i.result)throw new Error("accounts received is empty");return this._setAddresses(i.result),(n=this.callback)===null||n===void 0||n.call(this,"connect",{chainId:re(this.getChainId())}),this._addresses}async personalSign({params:e}){if(!Array.isArray(e))throw L.rpc.invalidParams();const n=e[1],s=e[0];this._ensureKnownAddress(n);const r=await this.initializeRelay().sendRequest({method:"signEthereumMessage",params:{address:ie(n),message:Ke(s),addPrefix:!0,typedDataJson:null}});if(z(r))throw r;return r.result}async _eth_signTransaction(e){const n=this._prepareTransactionParams(e[0]||{}),i=await this.initializeRelay().signEthereumTransaction(n);if(z(i))throw i;return i.result}async _eth_sendRawTransaction(e){const n=ot(e[0]),i=await this.initializeRelay().submitEthereumTransaction(n,this.getChainId());if(z(i))throw i;return i.result}async _eth_sendTransaction(e){const n=this._prepareTransactionParams(e[0]||{}),i=await this.initializeRelay().signAndSubmitEthereumTransaction(n);if(z(i))throw i;return i.result}async signTypedData(e){const{method:n,params:s}=e;if(!Array.isArray(s))throw L.rpc.invalidParams();const i=u=>{const p={eth_signTypedData_v1:Se.hashForSignTypedDataLegacy,eth_signTypedData_v3:Se.hashForSignTypedData_v3,eth_signTypedData_v4:Se.hashForSignTypedData_v4,eth_signTypedData:Se.hashForSignTypedData_v4};return ye(p[n]({data:ki(u)}),!0)},r=s[n==="eth_signTypedData_v1"?1:0],o=s[n==="eth_signTypedData_v1"?0:1];this._ensureKnownAddress(r);const d=await this.initializeRelay().sendRequest({method:"signEthereumMessage",params:{address:ie(r),message:i(o),typedDataJson:JSON.stringify(o,null,2),addPrefix:!1}});if(z(d))throw d;return d.result}initializeRelay(){return this._relay||(this._relay=new ee({linkAPIUrl:gn,storage:this._storage,metadata:this.metadata,accountsCallback:this._setAddresses.bind(this),chainCallback:this.updateProviderInfo.bind(this)})),this._relay}}const _s="SignerType",bs=new J("CBWSDK","SignerConfigurator");function Er(){return bs.getItem(_s)}function Ir(t){bs.setItem(_s,t)}async function xr(t){const{communicator:e,metadata:n,handshakeRequest:s,callback:i}=t;Sr(e,n,i).catch(()=>{});const r={id:crypto.randomUUID(),event:"selectSignerType",data:Object.assign(Object.assign({},t.preference),{handshakeRequest:s})},{data:o}=await e.postRequestAndWaitForResponse(r);return o}function Cr(t){const{signerType:e,metadata:n,communicator:s,callback:i}=t;switch(e){case"scw":return new Ui({metadata:n,callback:i,communicator:s});case"walletlink":return new ms({metadata:n,callback:i})}}async function Sr(t,e,n){await t.onMessage(({event:i})=>i==="WalletLinkSessionRequest");const s=new ms({metadata:e,callback:n});t.postMessage({event:"WalletLinkUpdate",data:{session:s.getSession()}}),await s.handshake(),t.postMessage({event:"WalletLinkUpdate",data:{connected:!0}})}const Ar=`Coinbase Wallet SDK requires the Cross-Origin-Opener-Policy header to not be set to 'same-origin'. This is to ensure that the SDK can communicate with the Coinbase Smart Wallet app.

Please see https://www.smartwallet.dev/guides/tips/popup-tips#cross-origin-opener-policy for more information.`,Lr=()=>{let t;return{getCrossOriginOpenerPolicy:()=>t===void 0?"undefined":t,checkCrossOriginOpenerPolicy:async()=>{if(typeof window>"u"){t="non-browser-env";return}try{const e=`${window.location.origin}${window.location.pathname}`,n=await fetch(e,{method:"HEAD"});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const s=n.headers.get("Cross-Origin-Opener-Policy");t=s??"null",t==="same-origin"&&console.error(Ar)}catch(e){console.error("Error checking Cross-Origin-Opener-Policy:",e.message),t="error"}}}},{checkCrossOriginOpenerPolicy:Mr,getCrossOriginOpenerPolicy:Pr}=Lr(),yn=420,wn=540,Tr={isRed:!1,info:"Retry",svgWidth:"10",svgHeight:"11",path:gs,defaultFillRule:"evenodd",defaultClipRule:"evenodd"},Or="Popup was blocked. Try again.";let Le=null;function Rr(t){const e=(window.innerWidth-yn)/2+window.screenX,n=(window.innerHeight-wn)/2+window.screenY;Dr(t);function s(){const r=`wallet_${crypto.randomUUID()}`,o=window.open(t,r,`width=${yn}, height=${wn}, left=${e}, top=${n}`);return o?.focus(),o||null}let i=s();if(!i){const r=Ur();return new Promise((o,a)=>{r.presentItem({autoExpand:!0,message:Or,menuItems:[Object.assign(Object.assign({},Tr),{onClick:()=>{i=s(),i?o(i):a(L.rpc.internal("Popup window was blocked")),r.clear()}})]})})}return Promise.resolve(i)}function Nr(t){t&&!t.closed&&t.close()}function Dr(t){const e={sdkName:Zn,sdkVersion:xe,origin:window.location.origin,coop:Pr()};for(const[n,s]of Object.entries(e))t.searchParams.append(n,s.toString())}function Ur(){if(!Le){const t=document.createElement("div");t.className="-cbwsdk-css-reset",document.body.appendChild(t),Le=new fs,Le.attach(t)}return Le}class Hr{constructor({url:e=wr,metadata:n,preference:s}){this.popup=null,this.listeners=new Map,this.postMessage=async i=>{(await this.waitForPopupLoaded()).postMessage(i,this.url.origin)},this.postRequestAndWaitForResponse=async i=>{const r=this.onMessage(({requestId:o})=>o===i.id);return this.postMessage(i),await r},this.onMessage=async i=>new Promise((r,o)=>{const a=d=>{if(d.origin!==this.url.origin)return;const u=d.data;i(u)&&(r(u),window.removeEventListener("message",a),this.listeners.delete(a))};window.addEventListener("message",a),this.listeners.set(a,{reject:o})}),this.disconnect=()=>{Nr(this.popup),this.popup=null,this.listeners.forEach(({reject:i},r)=>{i(L.provider.userRejectedRequest("Request rejected")),window.removeEventListener("message",r)}),this.listeners.clear()},this.waitForPopupLoaded=async()=>this.popup&&!this.popup.closed?(this.popup.focus(),this.popup):(this.popup=await Rr(this.url),this.onMessage(({event:i})=>i==="PopupUnload").then(this.disconnect).catch(()=>{}),this.onMessage(({event:i})=>i==="PopupLoaded").then(i=>{this.postMessage({requestId:i.id,data:{version:xe,metadata:this.metadata,preference:this.preference,location:window.location.toString()}})}).then(()=>{if(!this.popup)throw L.rpc.internal();return this.popup})),this.url=new URL(e),this.metadata=n,this.preference=s}}function Br(t){const e=_i(jr(t),{shouldIncludeStack:!0}),n=new URL("https://docs.cloud.coinbase.com/wallet-sdk/docs/errors");return n.searchParams.set("version",xe),n.searchParams.set("code",e.code.toString()),n.searchParams.set("message",e.message),Object.assign(Object.assign({},e),{docUrl:n.href})}function jr(t){var e;if(typeof t=="string")return{message:t,code:H.rpc.internal};if(z(t)){const n=t.errorMessage,s=(e=t.errorCode)!==null&&e!==void 0?e:n.match(/(denied|rejected)/i)?H.provider.userRejectedRequest:void 0;return Object.assign(Object.assign({},t),{message:n,code:s,data:{method:t.method}})}return t}var nt={exports:{}},vn;function Wr(){return vn||(vn=1,(function(t){var e=Object.prototype.hasOwnProperty,n="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(n=!1));function i(d,u,p){this.fn=d,this.context=u,this.once=p||!1}function r(d,u,p,c,h){if(typeof p!="function")throw new TypeError("The listener must be a function");var l=new i(p,c||d,h),f=n?n+u:u;return d._events[f]?d._events[f].fn?d._events[f]=[d._events[f],l]:d._events[f].push(l):(d._events[f]=l,d._eventsCount++),d}function o(d,u){--d._eventsCount===0?d._events=new s:delete d._events[u]}function a(){this._events=new s,this._eventsCount=0}a.prototype.eventNames=function(){var u=[],p,c;if(this._eventsCount===0)return u;for(c in p=this._events)e.call(p,c)&&u.push(n?c.slice(1):c);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(p)):u},a.prototype.listeners=function(u){var p=n?n+u:u,c=this._events[p];if(!c)return[];if(c.fn)return[c.fn];for(var h=0,l=c.length,f=new Array(l);h<l;h++)f[h]=c[h].fn;return f},a.prototype.listenerCount=function(u){var p=n?n+u:u,c=this._events[p];return c?c.fn?1:c.length:0},a.prototype.emit=function(u,p,c,h,l,f){var k=n?n+u:u;if(!this._events[k])return!1;var m=this._events[k],v=arguments.length,E,I;if(m.fn){switch(m.once&&this.removeListener(u,m.fn,void 0,!0),v){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,p),!0;case 3:return m.fn.call(m.context,p,c),!0;case 4:return m.fn.call(m.context,p,c,h),!0;case 5:return m.fn.call(m.context,p,c,h,l),!0;case 6:return m.fn.call(m.context,p,c,h,l,f),!0}for(I=1,E=new Array(v-1);I<v;I++)E[I-1]=arguments[I];m.fn.apply(m.context,E)}else{var x=m.length,y;for(I=0;I<x;I++)switch(m[I].once&&this.removeListener(u,m[I].fn,void 0,!0),v){case 1:m[I].fn.call(m[I].context);break;case 2:m[I].fn.call(m[I].context,p);break;case 3:m[I].fn.call(m[I].context,p,c);break;case 4:m[I].fn.call(m[I].context,p,c,h);break;default:if(!E)for(y=1,E=new Array(v-1);y<v;y++)E[y-1]=arguments[y];m[I].fn.apply(m[I].context,E)}}return!0},a.prototype.on=function(u,p,c){return r(this,u,p,c,!1)},a.prototype.once=function(u,p,c){return r(this,u,p,c,!0)},a.prototype.removeListener=function(u,p,c,h){var l=n?n+u:u;if(!this._events[l])return this;if(!p)return o(this,l),this;var f=this._events[l];if(f.fn)f.fn===p&&(!h||f.once)&&(!c||f.context===c)&&o(this,l);else{for(var k=0,m=[],v=f.length;k<v;k++)(f[k].fn!==p||h&&!f[k].once||c&&f[k].context!==c)&&m.push(f[k]);m.length?this._events[l]=m.length===1?m[0]:m:o(this,l)}return this},a.prototype.removeAllListeners=function(u){var p;return u?(p=n?n+u:u,this._events[p]&&o(this,p)):(this._events=new s,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a})(nt)),nt.exports}var qr=Wr();const $r=kn(qr);class zr extends $r{}var Vr=function(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(t);i<s.length;i++)e.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(t,s[i])&&(n[s[i]]=t[s[i]]);return n};class Fr extends zr{constructor(e){var{metadata:n}=e,s=e.preference,{keysUrl:i}=s,r=Vr(s,["keysUrl"]);super(),this.signer=null,this.isCoinbaseWallet=!0,this.metadata=n,this.preference=r,this.communicator=new Hr({url:i,metadata:n,preference:r});const o=Er();o&&(this.signer=this.initSigner(o))}async request(e){try{if(Di(e),!this.signer)switch(e.method){case"eth_requestAccounts":{const n=await this.requestSignerSelection(e),s=this.initSigner(n);await s.handshake(e),this.signer=s,Ir(n);break}case"wallet_sendCalls":{const n=this.initSigner("scw");await n.handshake({method:"handshake"});const s=await n.request(e);return await n.cleanup(),s}case"wallet_getCallsStatus":return kt(e,vr);case"net_version":return 1;case"eth_chainId":return re(1);default:throw L.provider.unauthorized("Must call 'eth_requestAccounts' before other methods")}return await this.signer.request(e)}catch(n){const{code:s}=n;return s===H.provider.unauthorized&&this.disconnect(),Promise.reject(Br(n))}}async enable(){return console.warn('.enable() has been deprecated. Please use .request({ method: "eth_requestAccounts" }) instead.'),await this.request({method:"eth_requestAccounts"})}async disconnect(){var e;await((e=this.signer)===null||e===void 0?void 0:e.cleanup()),this.signer=null,J.clearAll(),this.emit("disconnect",L.provider.disconnected("User initiated disconnection"))}requestSignerSelection(e){return xr({communicator:this.communicator,preference:this.preference,metadata:this.metadata,handshakeRequest:e,callback:this.emit.bind(this)})}initSigner(e){return Cr({signerType:e,metadata:this.metadata,communicator:this.communicator,callback:this.emit.bind(this)})}}function Kr(t){if(t){if(!["all","smartWalletOnly","eoaOnly"].includes(t.options))throw new Error(`Invalid options: ${t.options}`);if(t.attribution&&t.attribution.auto!==void 0&&t.attribution.dataSuffix!==void 0)throw new Error("Attribution cannot contain both auto and dataSuffix properties")}}class Zr{constructor(e){this.metadata={appName:e.appName||"Dapp",appLogoUrl:e.appLogoUrl||Ii(),appChainIds:e.appChainIds||[]},this.storeLatestVersion(),Mr()}makeWeb3Provider(e={options:"all"}){var n;Kr(e);const s={metadata:this.metadata,preference:e};return(n=Ni(s))!==null&&n!==void 0?n:new Fr(s)}getCoinbaseWalletLogo(e,n=240){return vs(e,n)}storeLatestVersion(){new J("CBWSDK").setItem("VERSION",xe)}}export{Zr as CoinbaseWalletSDK,Zr as default};
